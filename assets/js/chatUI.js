
/*!
Copyright © 2024 Saisha Pandit. All Rights Reserved.
Unauthorized use, modification, or distribution is strictly prohibited.
*/
const _0x347f47=_0x33fe;(function(_0x3de3bb,_0x276787){const _0x159f44=_0x33fe,_0x446683=_0x3de3bb();while(!![]){try{const _0x39f963=parseInt(_0x159f44(0x249))/0x1+parseInt(_0x159f44(0x1d4))/0x2+parseInt(_0x159f44(0x1da))/0x3*(-parseInt(_0x159f44(0x25b))/0x4)+-parseInt(_0x159f44(0x213))/0x5*(-parseInt(_0x159f44(0x21c))/0x6)+-parseInt(_0x159f44(0x205))/0x7+parseInt(_0x159f44(0x255))/0x8+-parseInt(_0x159f44(0x227))/0x9;if(_0x39f963===_0x276787)break;else _0x446683['push'](_0x446683['shift']());}catch(_0x35413a){_0x446683['push'](_0x446683['shift']());}}}(_0x3399,0x3eef3));function _0x33fe(_0x59de39,_0x4d4831){const _0x339978=_0x3399();return _0x33fe=function(_0x33fe7b,_0x31aa74){_0x33fe7b=_0x33fe7b-0x1d1;let _0x123db8=_0x339978[_0x33fe7b];return _0x123db8;},_0x33fe(_0x59de39,_0x4d4831);}import{AIAdapter,ModelTypes}from'./aiAdapter.js';export class ChatUI{constructor(){const _0x1f6713=_0x33fe,_0x3fa15e={'GuXqq':_0x1f6713(0x1ea),'dmObP':_0x1f6713(0x243),'fWgEI':_0x1f6713(0x245),'vUSXZ':'clear-cache','IpwlR':_0x1f6713(0x22f),'OIjlE':'settings-status-indicator','FcoIa':_0x1f6713(0x244),'unKgd':_0x1f6713(0x215),'pzFVI':_0x1f6713(0x1f3),'jJHVE':_0x1f6713(0x1e2),'iFGBU':'sessionConfig','CRied':_0x1f6713(0x1f8),'iPZhb':_0x1f6713(0x1df)};this[_0x1f6713(0x23a)]=null,this['selectedModel']=null,this[_0x1f6713(0x25a)]=!![],this[_0x1f6713(0x216)]=0x0,this['loadingStats']={'startTime':null,'progress':0x0,'estimatedTimeRemaining':0x0},this['progressText']='',this[_0x1f6713(0x1f9)]=![],this[_0x1f6713(0x216)]=0x0,this['modelLoaded']=![],this[_0x1f6713(0x20d)]=null,this['modelSelect']=document[_0x1f6713(0x238)](_0x3fa15e[_0x1f6713(0x228)]),this['loadModelBtn']=document[_0x1f6713(0x238)](_0x3fa15e[_0x1f6713(0x22a)]),this[_0x1f6713(0x1e7)]=document[_0x1f6713(0x238)](_0x3fa15e['fWgEI']),this[_0x1f6713(0x217)]=document[_0x1f6713(0x238)](_0x3fa15e[_0x1f6713(0x20b)]),this['checkCapabilityBtn']=document['getElementById'](_0x3fa15e[_0x1f6713(0x259)]),this[_0x1f6713(0x214)]=document['getElementById'](_0x3fa15e[_0x1f6713(0x21d)]),this[_0x1f6713(0x240)]=document[_0x1f6713(0x238)](_0x3fa15e['FcoIa']),this[_0x1f6713(0x1e3)]=document[_0x1f6713(0x238)](_0x1f6713(0x221)),this[_0x1f6713(0x254)]=document['getElementById'](_0x3fa15e[_0x1f6713(0x248)]),this[_0x1f6713(0x22c)]=document[_0x1f6713(0x238)](_0x1f6713(0x22c)),this[_0x1f6713(0x1f3)]=document[_0x1f6713(0x238)](_0x3fa15e['pzFVI']),this[_0x1f6713(0x1e2)]=document[_0x1f6713(0x238)](_0x3fa15e[_0x1f6713(0x225)]),this['maxTokens']=document[_0x1f6713(0x238)](_0x1f6713(0x231));const _0x3cd5ce=JSON[_0x1f6713(0x257)](localStorage[_0x1f6713(0x24d)](_0x3fa15e[_0x1f6713(0x253)]))||{'temperature':0.6,'topK':0x5,'topP':0.9,'maxTokens':0x400,'systemRole':_0x3fa15e[_0x1f6713(0x1e0)],'selectedModel':_0x3fa15e[_0x1f6713(0x224)]};if(this['temperature'])this[_0x1f6713(0x22c)][_0x1f6713(0x1f2)]=_0x3cd5ce['temperature'];if(this[_0x1f6713(0x1f3)])this[_0x1f6713(0x1f3)]['value']=_0x3cd5ce[_0x1f6713(0x1f3)];if(this['topP'])this['topP'][_0x1f6713(0x1f2)]=_0x3cd5ce[_0x1f6713(0x1e2)]||0.9;if(this['maxTokens'])this[_0x1f6713(0x231)][_0x1f6713(0x1f2)]=_0x3cd5ce[_0x1f6713(0x231)]||0x400;if(this[_0x1f6713(0x1e4)])this[_0x1f6713(0x1e4)][_0x1f6713(0x1f2)]=_0x3cd5ce[_0x1f6713(0x1e4)];if(this[_0x1f6713(0x24a)])this[_0x1f6713(0x24a)]['value']=_0x3cd5ce[_0x1f6713(0x1d2)]||_0x3fa15e[_0x1f6713(0x224)];this[_0x1f6713(0x250)]();}async[_0x347f47(0x250)](){const _0x56f36d=_0x347f47,_0x4358b7={'FtHuZ':function(_0x3203b3,_0x52b845){return _0x3203b3(_0x52b845);},'jRDNr':function(_0x2dedfd,_0x556830){return _0x2dedfd(_0x556830);},'RsPyM':_0x56f36d(0x1f0),'yCZXU':_0x56f36d(0x1df),'IQGsX':_0x56f36d(0x1fd),'aSvOy':'change','tEgtk':_0x56f36d(0x1db),'MKsDY':_0x56f36d(0x22b)};console[_0x56f36d(0x206)](_0x4358b7['tEgtk']);this[_0x56f36d(0x234)]&&this[_0x56f36d(0x234)]['addEventListener'](_0x4358b7['MKsDY'],this[_0x56f36d(0x1d3)][_0x56f36d(0x223)](this));this[_0x56f36d(0x201)]&&this['checkCapabilityBtn'][_0x56f36d(0x20c)](_0x56f36d(0x22b),this[_0x56f36d(0x207)]);await this['checkWebGPUCapability']();this['clearCacheBtn']&&this[_0x56f36d(0x217)][_0x56f36d(0x20c)](_0x4358b7['MKsDY'],()=>{const _0x19ecdc=_0x56f36d;location[_0x19ecdc(0x21b)]();});const _0x44d6d1=()=>{const _0x13700a=_0x56f36d,_0x15e717={'temperature':_0x4358b7[_0x13700a(0x24c)](parseFloat,this[_0x13700a(0x22c)]?.['value']||0.6),'topK':_0x4358b7[_0x13700a(0x1d6)](parseInt,this[_0x13700a(0x1f3)]?.[_0x13700a(0x1f2)]||0x5),'topP':parseFloat(this[_0x13700a(0x1e2)]?.[_0x13700a(0x1f2)]||0.9),'maxTokens':parseInt(this[_0x13700a(0x231)]?.[_0x13700a(0x1f2)]||0x400),'systemRole':this['systemRole']?.[_0x13700a(0x1f2)]||_0x4358b7[_0x13700a(0x1de)],'selectedModel':this[_0x13700a(0x24a)]?.[_0x13700a(0x1f2)]||_0x4358b7[_0x13700a(0x1eb)]};localStorage['setItem'](_0x4358b7[_0x13700a(0x23f)],JSON[_0x13700a(0x252)](_0x15e717));};[this[_0x56f36d(0x22c)],this[_0x56f36d(0x1f3)],this[_0x56f36d(0x1e2)],this[_0x56f36d(0x231)],this[_0x56f36d(0x1e4)],this['modelSelect']]['forEach'](_0x49e3a8=>{const _0x69a985=_0x56f36d;_0x49e3a8&&_0x49e3a8[_0x69a985(0x20c)](_0x4358b7['aSvOy'],_0x44d6d1);}),console[_0x56f36d(0x206)](_0x56f36d(0x1fa));}async['isModelLoaded'](){const _0x250006=_0x347f47,_0x5222d6={'eGqkG':_0x250006(0x1ff)};if(!this[_0x250006(0x23a)]||!this[_0x250006(0x1d2)])return![];try{return await this[_0x250006(0x23a)][_0x250006(0x260)](this[_0x250006(0x1d2)]);}catch(_0x3d5f66){return console[_0x250006(0x236)](_0x5222d6['eGqkG'],_0x3d5f66),![];}}async[_0x347f47(0x207)](){const _0x37c150=_0x347f47,_0x3283ce={'yDGEY':_0x37c150(0x20f),'uCqru':_0x37c150(0x208),'cZUXh':_0x37c150(0x204),'hgfMe':_0x37c150(0x212),'KtsWO':_0x37c150(0x226)};try{if(navigator['gpu']){const _0x1987bc=await navigator['gpu'][_0x37c150(0x1fc)](),_0x5d37c1=_0x1987bc?await _0x1987bc[_0x37c150(0x21e)]():null;if(_0x5d37c1)return this['modelInfo'][_0x37c150(0x200)]=_0x3283ce[_0x37c150(0x211)],this[_0x37c150(0x201)][_0x37c150(0x1f1)]=_0x37c150(0x25f),this[_0x37c150(0x201)]['disabled']=!![],this['checkCapabilityBtn'][_0x37c150(0x24f)][_0x37c150(0x1e9)]='#4CAF50',!![];}return this[_0x37c150(0x1e7)][_0x37c150(0x200)]=_0x3283ce['uCqru'],this[_0x37c150(0x201)][_0x37c150(0x1f1)]=_0x3283ce['cZUXh'],this[_0x37c150(0x201)][_0x37c150(0x1f6)]=!![],this[_0x37c150(0x201)][_0x37c150(0x24f)][_0x37c150(0x1e9)]=_0x3283ce['hgfMe'],![];}catch(_0x565a6d){return console[_0x37c150(0x236)](_0x3283ce['KtsWO'],_0x565a6d),this[_0x37c150(0x1e7)][_0x37c150(0x200)]='<span\x20style=\x22color:\x20var(--error-color);\x22>Error\x20checking\x20WebGPU\x20support.\x20Models\x20may\x20not\x20run\x20locally.</span>',![];}}async[_0x347f47(0x203)](){const _0x5c33c0=_0x347f47,_0xb698c4={'CASlU':_0x5c33c0(0x229),'sVDTm':_0x5c33c0(0x1d9),'pIfNU':_0x5c33c0(0x23e),'skQFd':_0x5c33c0(0x220)};try{if(!this[_0x5c33c0(0x23a)]||!this[_0x5c33c0(0x1d2)])throw new Error('AI\x20adapter\x20or\x20model\x20not\x20set');const _0x24f6ab=await this['aiAdapter'][_0x5c33c0(0x260)](this[_0x5c33c0(0x1d2)]);this[_0x5c33c0(0x214)][_0x5c33c0(0x23c)]=_0x24f6ab?_0xb698c4['CASlU']:'settings-status-indicator\x20settings-status-not-loaded',this[_0x5c33c0(0x240)]['innerText']=_0x24f6ab?_0xb698c4[_0x5c33c0(0x230)]:_0xb698c4['pIfNU'];}catch(_0x2fb2c1){console[_0x5c33c0(0x236)](_0xb698c4[_0x5c33c0(0x25c)],_0x2fb2c1),this['statusIndicator']['className']=_0x5c33c0(0x22d),this[_0x5c33c0(0x240)][_0x5c33c0(0x1f1)]='Error\x20checking\x20status';}}['isModelCached'](){const _0x3302c9=_0x347f47;if(!this[_0x3302c9(0x23a)])return![];return this[_0x3302c9(0x23a)][_0x3302c9(0x260)]();}async[_0x347f47(0x1d3)](){const _0x29db26=_0x347f47,_0x26845b={'KuSss':_0x29db26(0x1dc),'eRqkk':'green','QrGdT':_0x29db26(0x229),'KRDmM':function(_0x463b48,_0x370e3f){return _0x463b48-_0x370e3f;},'fdgyQ':_0x29db26(0x21f),'AFUlD':'red','bWpFB':_0x29db26(0x21a),'yuyPm':function(_0x69bb22,_0x2b8832){return _0x69bb22(_0x2b8832);}};try{this[_0x29db26(0x234)]['disabled']=!![],this[_0x29db26(0x240)]['textContent']=_0x26845b[_0x29db26(0x237)],this[_0x29db26(0x240)][_0x29db26(0x24f)][_0x29db26(0x1d1)]='orange',this[_0x29db26(0x1d2)]=this[_0x29db26(0x24a)]['value'],console[_0x29db26(0x206)]('[ChatUI]\x20Selected\x20model\x20identifier:\x20'+this[_0x29db26(0x1d2)]),this[_0x29db26(0x23a)]=AIAdapter[_0x29db26(0x1f7)](this[_0x29db26(0x1d2)]);const _0x47030f=await this[_0x29db26(0x23a)]['init']();this['setupProgressUpdates']();if(_0x47030f[_0x29db26(0x22e)]){this[_0x29db26(0x247)]=!![],this[_0x29db26(0x1d2)]=this[_0x29db26(0x1d2)],this['statusText']['textContent']=_0x29db26(0x23d)+this['getModelTypeDisplay'](_0x47030f)+')',this[_0x29db26(0x240)][_0x29db26(0x24f)][_0x29db26(0x1d1)]=_0x26845b[_0x29db26(0x242)],this[_0x29db26(0x214)][_0x29db26(0x23c)]=_0x26845b[_0x29db26(0x20e)],this[_0x29db26(0x234)]['disabled']=!![];const _0x1b48a3=_0x26845b['KRDmM'](performance['now'](),this[_0x29db26(0x23a)]['startTime'])[_0x29db26(0x1ec)](0x2);this[_0x29db26(0x254)][_0x29db26(0x218)]=_0x1b48a3+'\x20ms',this['memoryUsage'][_0x29db26(0x218)]=this['getModelTypeDisplay'](_0x47030f);}else this[_0x29db26(0x240)][_0x29db26(0x218)]=_0x29db26(0x1e5)+(_0x47030f['error']||_0x26845b[_0x29db26(0x232)]),this[_0x29db26(0x240)][_0x29db26(0x24f)][_0x29db26(0x1d1)]=_0x26845b[_0x29db26(0x1fb)],this['loadModelBtn'][_0x29db26(0x1f6)]=![];}catch(_0x50aa46){this[_0x29db26(0x240)][_0x29db26(0x218)]=_0x29db26(0x1e5)+_0x50aa46[_0x29db26(0x1d5)],this['statusText'][_0x29db26(0x24f)][_0x29db26(0x1d1)]=_0x29db26(0x20a),this['loadModelBtn'][_0x29db26(0x1f6)]=![],console['error'](_0x26845b['bWpFB'],_0x50aa46);}finally{this[_0x29db26(0x20d)]&&(_0x26845b[_0x29db26(0x219)](clearInterval,this[_0x29db26(0x20d)]),this[_0x29db26(0x20d)]=null);}}[_0x347f47(0x209)](_0x5f5c17){const _0x5ac89c=_0x347f47,_0x1e0e89={'HNtLj':_0x5ac89c(0x209),'wWVfY':function(_0x55a422,_0x1adc70){return _0x55a422===_0x1adc70;},'GrwOS':_0x5ac89c(0x239),'rAJoN':function(_0x1ffcf2,_0x317c4d){return _0x1ffcf2===_0x317c4d;},'Zudvi':_0x5ac89c(0x233),'bqOCB':'OpenAI\x20API'};console[_0x5ac89c(0x206)](_0x1e0e89['HNtLj'],JSON[_0x5ac89c(0x252)](_0x5f5c17));if(!_0x5f5c17||!_0x5f5c17['modelType'])return'';if(_0x1e0e89['wWVfY'](_0x5f5c17['modelType'],ModelTypes['MLC_AI']))return _0x1e0e89['GrwOS'];else{if(_0x1e0e89['rAJoN'](_0x5f5c17[_0x5ac89c(0x1f5)],ModelTypes[_0x5ac89c(0x1ed)]))return _0x1e0e89[_0x5ac89c(0x222)];else return _0x1e0e89[_0x5ac89c(0x235)](_0x5f5c17[_0x5ac89c(0x1f5)],ModelTypes[_0x5ac89c(0x1d7)])?_0x1e0e89[_0x5ac89c(0x1e1)]:'';}}[_0x347f47(0x251)](_0x23aab7){const _0x1c24f3=_0x347f47,_0x4d8139={'QqLBo':function(_0x385f30,_0x18397e){return _0x385f30/_0x18397e;},'ISoVp':function(_0x3488d8,_0x2e30fe){return _0x3488d8%_0x2e30fe;}};return _0x23aab7<0x3c?Math[_0x1c24f3(0x1e6)](_0x23aab7)+_0x1c24f3(0x1dd):Math[_0x1c24f3(0x1e6)](_0x4d8139[_0x1c24f3(0x24e)](_0x23aab7,0x3c))+'m\x20'+Math[_0x1c24f3(0x1e6)](_0x4d8139['ISoVp'](_0x23aab7,0x3c))+_0x1c24f3(0x1dd);}['calculateTimeRemaining'](_0x4b2a70,_0x1901be){const _0x13b8e4=_0x347f47,_0x1554c5={'OkIgs':function(_0x443aab,_0x3853e3){return _0x443aab<=_0x3853e3;},'IQaJV':function(_0x1b6c17,_0x4f477c){return _0x1b6c17>=_0x4f477c;},'ynGwN':function(_0x33c30d,_0x11f012){return _0x33c30d/_0x11f012;},'CjaLi':function(_0x207304,_0x441ccb){return _0x207304*_0x441ccb;},'jLMsF':function(_0x11239e,_0x507788){return _0x11239e*_0x507788;}};if(_0x1554c5[_0x13b8e4(0x1f4)](_0x1901be,0x0)||_0x1554c5[_0x13b8e4(0x202)](_0x1901be,0x1))return 0x0;const _0x948988=(performance['now']()-_0x4b2a70)/0x3e8,_0x57b707=_0x1554c5[_0x13b8e4(0x25e)](_0x948988,_0x1901be*0x64);return _0x1554c5[_0x13b8e4(0x1fe)](_0x57b707,0x64-_0x1554c5[_0x13b8e4(0x23b)](_0x1901be,0x64));}[_0x347f47(0x210)](){const _0x4a3b0d=_0x347f47,_0x4d8de7={'VLonv':function(_0x3be1d2,_0x1f4b95){return _0x3be1d2>_0x1f4b95;},'WAXUp':function(_0x43af4f,_0x73fd3e){return _0x43af4f>=_0x73fd3e;},'hGJKP':function(_0x5155ba,_0x3cf0b7){return _0x5155ba(_0x3cf0b7);},'gXfSN':function(_0x57f193,_0x4824fd,_0x5ae06c){return _0x57f193(_0x4824fd,_0x5ae06c);}};this[_0x4a3b0d(0x20d)]&&clearInterval(this['progressUpdateInterval']),this[_0x4a3b0d(0x20d)]=_0x4d8de7[_0x4a3b0d(0x24b)](setInterval,()=>{const _0x11cf17=_0x4a3b0d;if(this[_0x11cf17(0x23a)]){const _0x53a9dd=this[_0x11cf17(0x23a)]['loadingProgress'],_0x28d451=this[_0x11cf17(0x23a)]['progressText'];if(_0x4d8de7[_0x11cf17(0x258)](_0x53a9dd,0x0)&&_0x53a9dd<0x64){const _0x585971=this[_0x11cf17(0x23a)][_0x11cf17(0x246)]['estimatedTimeRemaining'];let _0x11fd42=_0x11cf17(0x25d)+Math[_0x11cf17(0x256)](_0x53a9dd)+'%';_0x585971&&_0x4d8de7[_0x11cf17(0x258)](_0x585971,0x0)&&(_0x11fd42+='\x20('+this[_0x11cf17(0x251)](_0x585971)+')'),_0x28d451&&(_0x11fd42+=_0x11cf17(0x1ee)+_0x28d451),this['statusText'][_0x11cf17(0x218)]=_0x11fd42;}else _0x28d451&&(this[_0x11cf17(0x240)][_0x11cf17(0x218)]=_0x28d451);(_0x4d8de7[_0x11cf17(0x1d8)](_0x53a9dd,0x64)||this[_0x11cf17(0x23a)]['isInitialized'])&&(_0x4d8de7[_0x11cf17(0x1ef)](clearInterval,this[_0x11cf17(0x20d)]),this['progressUpdateInterval']=null);}},0xc8);}[_0x347f47(0x1e8)](){const _0x473f3e=_0x347f47,_0x552ca3={'iVNOj':function(_0x4d09a2,_0x3ef4be){return _0x4d09a2(_0x3ef4be);}};this['progressUpdateInterval']&&(_0x552ca3[_0x473f3e(0x241)](clearInterval,this[_0x473f3e(0x20d)]),this[_0x473f3e(0x20d)]=null),this[_0x473f3e(0x23a)]&&(this['aiAdapter'][_0x473f3e(0x1e8)](),this['aiAdapter']=null);}}function _0x3399(){const _0x4f5d13=['iFGBU','modelLoadTime','2351656IMTMOX','round','parse','VLonv','IpwlR','useWebWorker','20KftEtz','skQFd','Loading:\x20','ynGwN','WebGPU\x20Supported\x20✓','isModelCached','color','selectedModel','handleLoadModel','993450xTjwKZ','message','jRDNr','OPEN_AI','WAXUp','Cached\x20(Click\x20Download\x20to\x20load)','187182ombMlo','[ChatUI]\x20ChatUI\x20initialized','Loading\x20model...','s\x20remaining','RsPyM','tinyllama-1.1b-chat-v0.4','CRied','bqOCB','topP','memoryUsage','systemRole','Error:\x20','floor','modelInfo','cleanup','backgroundColor','model-select','yCZXU','toFixed','BROWSER_AI','\x20-\x20','hGJKP','You\x20are\x20a\x20helpful\x20assistant.','innerText','value','topK','OkIgs','modelType','disabled','getInstance','You\x20are\x20a\x20helpful\x20assistant4.','loading','[ChatUI]:\x20UI\x20initialized','AFUlD','requestAdapter','sessionConfig','CjaLi','Error\x20checking\x20if\x20model\x20is\x20loaded:','innerHTML','checkCapabilityBtn','IQaJV','checkModelStatus','WebGPU\x20Not\x20Supported\x20✗','3149671Hlujwl','log','checkWebGPUCapability','<span\x20style=\x22color:\x20var(--error-color);\x22>WebGPU\x20not\x20supported.\x20Models\x20will\x20not\x20run\x20locally.</span>','getModelTypeDisplay','red','vUSXZ','addEventListener','progressUpdateInterval','QrGdT','WebGPU\x20is\x20supported!\x20Models\x20will\x20run\x20locally\x20in\x20your\x20browser.','setupProgressUpdates','yDGEY','#F44336','67185qcALOm','statusIndicator','model-load-time','loadingProgress','clearCacheBtn','textContent','yuyPm','[ChatUI]\x20Model\x20load\x20error:','reload','36VnjOmx','OIjlE','requestDevice','Failed\x20to\x20initialize\x20model','Error\x20checking\x20model\x20status:','memory-usage','Zudvi','bind','iPZhb','jJHVE','Error\x20checking\x20WebGPU\x20capability:','2938050cYuftq','GuXqq','settings-status-indicator\x20settings-status-ready','dmObP','click','temperature','settings-status-indicator\x20settings-status-not-loaded','success','check-capability-btn','sVDTm','maxTokens','fdgyQ','Browser\x20AI\x20API','loadModelBtn','wWVfY','error','KuSss','getElementById','WebGPU\x20(MLC)','aiAdapter','jLMsF','className','Model\x20Loaded\x20Successfully\x20(','Not\x20Cached\x20(Click\x20Download\x20to\x20load)','IQGsX','statusText','iVNOj','eRqkk','download-model','settings-status-text','model-info','loadingStats','modelLoaded','unKgd','474848ukTgOE','modelSelect','gXfSN','FtHuZ','getItem','QqLBo','style','initializeUI','formatTimeRemaining','stringify'];_0x3399=function(){return _0x4f5d13;};return _0x3399();}