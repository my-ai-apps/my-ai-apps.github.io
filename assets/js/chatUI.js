
/*!
Copyright © 2024 Saisha Pandit. All Rights Reserved.
Unauthorized use, modification, or distribution is strictly prohibited.
*/
const _0x1d8aaf=_0x41b5;function _0x41b5(_0x479a30,_0x4d288d){const _0x1921af=_0x1921();return _0x41b5=function(_0x41b59e,_0x4fb0b4){_0x41b59e=_0x41b59e-0x126;let _0x185a93=_0x1921af[_0x41b59e];return _0x185a93;},_0x41b5(_0x479a30,_0x4d288d);}(function(_0x488f5b,_0x1214e4){const _0x38b23b=_0x41b5,_0x38f3bc=_0x488f5b();while(!![]){try{const _0x45dda7=-parseInt(_0x38b23b(0x165))/0x1*(-parseInt(_0x38b23b(0x185))/0x2)+parseInt(_0x38b23b(0x141))/0x3*(-parseInt(_0x38b23b(0x183))/0x4)+parseInt(_0x38b23b(0x162))/0x5*(parseInt(_0x38b23b(0x1b5))/0x6)+parseInt(_0x38b23b(0x142))/0x7*(-parseInt(_0x38b23b(0x139))/0x8)+-parseInt(_0x38b23b(0x149))/0x9*(parseInt(_0x38b23b(0x1b7))/0xa)+parseInt(_0x38b23b(0x1a1))/0xb+parseInt(_0x38b23b(0x132))/0xc*(parseInt(_0x38b23b(0x16c))/0xd);if(_0x45dda7===_0x1214e4)break;else _0x38f3bc['push'](_0x38f3bc['shift']());}catch(_0x57a52a){_0x38f3bc['push'](_0x38f3bc['shift']());}}}(_0x1921,0x6fa9d));import{AIAdapter,ModelTypes}from'./aiAdapter.js';function _0x1921(){const _0x32de80=['progressText','s\x20remaining','requestDevice','check-capability-btn','Loading\x20model...','change','progressUpdateInterval','addEventListener','Browser\x20AI\x20API','VEfDM','topP','fSqCN','SjlIi','tCqbL','rXcUq','useWebWorker','click','orange','275869AAvsMz','toFixed','checkCapabilityBtn','value','NGoZx','style','model-load-time','color','oyKXu','temperature','modelLoaded','tTQkI','yiXdW','round','sessionConfig','clear-cache','init','modelSelect','requestAdapter','yfgxE','224706razcVj','startTime','10QEVhBX','getItem','innerText','[ChatUI]\x20Selected\x20model\x20identifier:\x20','BRHEH','#4CAF50','modelInfo','maxTokens','statusText','getElementById','rgEUy','settings-status-indicator\x20settings-status-ready','NyXWC','error','\x20ms','loadingProgress','setItem','OPEN_AI','64572eOPXOZ','WebGPU\x20Not\x20Supported\x20✗','\x20-\x20','settings-status-indicator\x20settings-status-not-loaded','setupProgressUpdates','settings-status-text','WebGPU\x20is\x20supported!\x20Models\x20will\x20run\x20locally\x20in\x20your\x20browser.','4323544BkzAEz','initializeUI','clearCacheBtn','xzdYS','checkWebGPUCapability','settings-status-indicator','loadModelBtn','ONQWe','111coDkki','7ZCNMpr','You\x20are\x20a\x20helpful\x20assistant.','dAkNm','Loading:\x20','statusIndicator','OCuAO','topK','3217653sissLG','<span\x20style=\x22color:\x20var(--error-color);\x22>Error\x20checking\x20WebGPU\x20support.\x20Models\x20may\x20not\x20run\x20locally.</span>','isModelLoaded','SnNSF','Error\x20checking\x20status','0|3|2|4|1','tinyllama-1.1b-chat-v0.4','innerHTML','systemRole','modelLoadTime','zLDuH','Oizfl','jVZOo','log','dfwXp','WebGPU\x20(MLC)','EOMrn','getModelTypeDisplay','calculateTimeRemaining','className','uxgkO','[ChatUI]:\x20UI\x20initialized','isModelCached','[ChatUI]\x20ChatUI\x20initialized','DFKFd','95unIzIk','bind','textContent','1PWrujY','loadingStats','checkModelStatus','AMpyi','memoryUsage','estimatedTimeRemaining','aiAdapter','1651PxlgOT','getInstance','disabled','MLC_AI','kVlUy','forEach','tijfS','Error\x20checking\x20WebGPU\x20capability:','backgroundColor','LmRfW','Error\x20checking\x20model\x20status:','qWsox','Model\x20Loaded\x20Successfully\x20(','cleanup','model-select','loading','Not\x20Cached\x20(Click\x20Download\x20to\x20load)','WqaUD','gpu','parse','stringify','modelType','Error:\x20','24652zJhEBQ','AI\x20adapter\x20or\x20model\x20not\x20set','326658Womodd','now','#F44336','floor','formatTimeRemaining','selectedModel','reload','MGllH','Failed\x20to\x20initialize\x20model','julJf'];_0x1921=function(){return _0x32de80;};return _0x1921();}export class ChatUI{constructor(){const _0x297848=_0x41b5,_0x39a0f9={'xzdYS':_0x297848(0x17a),'WqaUD':'download-model','qMoXM':'model-info','LmRfW':_0x297848(0x192),'rXcUq':_0x297848(0x137),'LSRyI':_0x297848(0x1a7),'tijfS':_0x297848(0x148),'uxgkO':'topP','BRHEH':'maxTokens','zcmvL':_0x297848(0x1af),'ONQWe':'You\x20are\x20a\x20helpful\x20assistant.','VAQYy':_0x297848(0x14f)};this[_0x297848(0x16b)]=null,this[_0x297848(0x18a)]=null,this[_0x297848(0x19e)]=!![],this[_0x297848(0x12f)]=0x0,this['loadingStats']={'startTime':null,'progress':0x0,'estimatedTimeRemaining':0x0},this[_0x297848(0x18f)]='',this[_0x297848(0x17b)]=![],this[_0x297848(0x12f)]=0x0,this[_0x297848(0x1ab)]=![],this[_0x297848(0x195)]=null,this[_0x297848(0x1b2)]=document[_0x297848(0x129)](_0x39a0f9[_0x297848(0x13c)]),this[_0x297848(0x13f)]=document[_0x297848(0x129)](_0x39a0f9[_0x297848(0x17d)]),this[_0x297848(0x126)]=document[_0x297848(0x129)](_0x39a0f9['qMoXM']),this[_0x297848(0x13b)]=document[_0x297848(0x129)](_0x297848(0x1b0)),this[_0x297848(0x1a3)]=document[_0x297848(0x129)](_0x39a0f9[_0x297848(0x175)]),this[_0x297848(0x146)]=document[_0x297848(0x129)](_0x297848(0x13e)),this[_0x297848(0x128)]=document[_0x297848(0x129)](_0x39a0f9[_0x297848(0x19d)]),this[_0x297848(0x169)]=document[_0x297848(0x129)]('memory-usage'),this[_0x297848(0x152)]=document[_0x297848(0x129)](_0x39a0f9['LSRyI']),this[_0x297848(0x1aa)]=document[_0x297848(0x129)](_0x297848(0x1aa)),this[_0x297848(0x148)]=document[_0x297848(0x129)](_0x39a0f9[_0x297848(0x172)]),this['topP']=document[_0x297848(0x129)](_0x39a0f9[_0x297848(0x15d)]),this['maxTokens']=document[_0x297848(0x129)](_0x39a0f9[_0x297848(0x1bb)]);const _0x26be7=JSON[_0x297848(0x17f)](localStorage[_0x297848(0x1b8)](_0x39a0f9['zcmvL']))||{'temperature':0.6,'topK':0x5,'topP':0.9,'maxTokens':0x400,'systemRole':_0x39a0f9[_0x297848(0x140)],'selectedModel':_0x39a0f9['VAQYy']};if(this[_0x297848(0x1aa)])this[_0x297848(0x1aa)][_0x297848(0x1a4)]=_0x26be7['temperature'];if(this['topK'])this[_0x297848(0x148)][_0x297848(0x1a4)]=_0x26be7[_0x297848(0x148)];if(this['topP'])this[_0x297848(0x199)]['value']=_0x26be7[_0x297848(0x199)]||0.9;if(this[_0x297848(0x127)])this[_0x297848(0x127)][_0x297848(0x1a4)]=_0x26be7[_0x297848(0x127)]||0x400;if(this[_0x297848(0x151)])this[_0x297848(0x151)][_0x297848(0x1a4)]=_0x26be7['systemRole'];if(this[_0x297848(0x1b2)])this[_0x297848(0x1b2)]['value']=_0x26be7[_0x297848(0x18a)]||_0x39a0f9['VAQYy'];this[_0x297848(0x13a)]();}async['initializeUI'](){const _0x267707=_0x41b5,_0x332aba={'DFKFd':function(_0x46268c,_0x346a0c){return _0x46268c(_0x346a0c);},'CyaHd':function(_0x414e74,_0x598b05){return _0x414e74(_0x598b05);},'tCqbL':function(_0x36c621,_0x155d4d){return _0x36c621(_0x155d4d);},'yfgxE':_0x267707(0x143),'SjlIi':_0x267707(0x14f),'dsIhr':_0x267707(0x194),'AMpyi':_0x267707(0x19f),'SnNSF':_0x267707(0x15e)};console[_0x267707(0x156)](_0x267707(0x160));this[_0x267707(0x13f)]&&this[_0x267707(0x13f)][_0x267707(0x196)](_0x332aba[_0x267707(0x168)],this['handleLoadModel'][_0x267707(0x163)](this));this['checkCapabilityBtn']&&this[_0x267707(0x1a3)][_0x267707(0x196)]('click',this[_0x267707(0x13d)]);await this[_0x267707(0x13d)]();this[_0x267707(0x13b)]&&this[_0x267707(0x13b)][_0x267707(0x196)](_0x267707(0x19f),()=>{const _0x4b4486=_0x267707;location[_0x4b4486(0x18b)]();});const _0x1eb18c=()=>{const _0x18e86e=_0x267707,_0xf8458d={'temperature':_0x332aba[_0x18e86e(0x161)](parseFloat,this['temperature']?.['value']||0.6),'topK':_0x332aba['CyaHd'](parseInt,this['topK']?.[_0x18e86e(0x1a4)]||0x5),'topP':_0x332aba[_0x18e86e(0x19c)](parseFloat,this[_0x18e86e(0x199)]?.[_0x18e86e(0x1a4)]||0.9),'maxTokens':_0x332aba[_0x18e86e(0x161)](parseInt,this[_0x18e86e(0x127)]?.[_0x18e86e(0x1a4)]||0x400),'systemRole':this[_0x18e86e(0x151)]?.[_0x18e86e(0x1a4)]||_0x332aba[_0x18e86e(0x1b4)],'selectedModel':this[_0x18e86e(0x1b2)]?.['value']||_0x332aba[_0x18e86e(0x19b)]};localStorage[_0x18e86e(0x130)](_0x18e86e(0x1af),JSON[_0x18e86e(0x180)](_0xf8458d));};[this['temperature'],this[_0x267707(0x148)],this[_0x267707(0x199)],this[_0x267707(0x127)],this[_0x267707(0x151)],this['modelSelect']][_0x267707(0x171)](_0xf638cc=>{const _0x1b56ac=_0x267707;_0xf638cc&&_0xf638cc[_0x1b56ac(0x196)](_0x332aba['dsIhr'],_0x1eb18c);}),console[_0x267707(0x156)](_0x332aba[_0x267707(0x14c)]);}async[_0x1d8aaf(0x14b)](){const _0x356fcc=_0x1d8aaf;if(!this[_0x356fcc(0x16b)]||!this[_0x356fcc(0x18a)])return![];try{return await this[_0x356fcc(0x16b)]['isModelCached'](this[_0x356fcc(0x18a)]);}catch(_0x5e4c55){return console[_0x356fcc(0x12d)]('Error\x20checking\x20if\x20model\x20is\x20loaded:',_0x5e4c55),![];}}async['checkWebGPUCapability'](){const _0xd7c701=_0x1d8aaf,_0x506374={'EOMrn':_0xd7c701(0x14e),'jVZOo':_0xd7c701(0x138),'aVvOJ':_0xd7c701(0x1bc),'MGllH':'<span\x20style=\x22color:\x20var(--error-color);\x22>WebGPU\x20not\x20supported.\x20Models\x20will\x20not\x20run\x20locally.</span>','GpVYY':_0xd7c701(0x133),'mDNyW':_0xd7c701(0x173),'fSqCN':_0xd7c701(0x14a)};try{if(navigator[_0xd7c701(0x17e)]){const _0x346241=await navigator[_0xd7c701(0x17e)][_0xd7c701(0x1b3)](),_0x56c041=_0x346241?await _0x346241[_0xd7c701(0x191)]():null;if(_0x56c041){const _0x19b07a=_0x506374[_0xd7c701(0x159)]['split']('|');let _0x568485=0x0;while(!![]){switch(_0x19b07a[_0x568485++]){case'0':this[_0xd7c701(0x126)][_0xd7c701(0x150)]=_0x506374[_0xd7c701(0x155)];continue;case'1':return!![];case'2':this['checkCapabilityBtn'][_0xd7c701(0x16e)]=!![];continue;case'3':this[_0xd7c701(0x1a3)][_0xd7c701(0x1b9)]='WebGPU\x20Supported\x20✓';continue;case'4':this[_0xd7c701(0x1a3)]['style'][_0xd7c701(0x174)]=_0x506374['aVvOJ'];continue;}break;}}}return this[_0xd7c701(0x126)][_0xd7c701(0x150)]=_0x506374[_0xd7c701(0x18c)],this[_0xd7c701(0x1a3)][_0xd7c701(0x1b9)]=_0x506374['GpVYY'],this[_0xd7c701(0x1a3)][_0xd7c701(0x16e)]=!![],this[_0xd7c701(0x1a3)][_0xd7c701(0x1a6)][_0xd7c701(0x174)]=_0xd7c701(0x187),![];}catch(_0x1100bd){return console['error'](_0x506374['mDNyW'],_0x1100bd),this[_0xd7c701(0x126)]['innerHTML']=_0x506374[_0xd7c701(0x19a)],![];}}async[_0x1d8aaf(0x167)](){const _0x351f5d=_0x1d8aaf,_0x41087d={'zLDuH':_0x351f5d(0x184),'NGoZx':_0x351f5d(0x12b),'tTQkI':_0x351f5d(0x135),'tXoIB':'Cached\x20(Click\x20Download\x20to\x20load)','DVfLE':_0x351f5d(0x17c),'rgEUy':_0x351f5d(0x14d)};try{if(!this[_0x351f5d(0x16b)]||!this['selectedModel'])throw new Error(_0x41087d[_0x351f5d(0x153)]);const _0x20ed63=await this['aiAdapter'][_0x351f5d(0x15f)](this[_0x351f5d(0x18a)]);this[_0x351f5d(0x146)][_0x351f5d(0x15c)]=_0x20ed63?_0x41087d[_0x351f5d(0x1a5)]:_0x41087d[_0x351f5d(0x1ac)],this[_0x351f5d(0x128)][_0x351f5d(0x1b9)]=_0x20ed63?_0x41087d['tXoIB']:_0x41087d['DVfLE'];}catch(_0x5a3e58){console[_0x351f5d(0x12d)](_0x351f5d(0x176),_0x5a3e58),this[_0x351f5d(0x146)]['className']=_0x351f5d(0x135),this['statusText']['innerText']=_0x41087d[_0x351f5d(0x12a)];}}[_0x1d8aaf(0x15f)](){const _0x22acec=_0x1d8aaf;if(!this['aiAdapter'])return![];return this[_0x22acec(0x16b)][_0x22acec(0x15f)]();}async['handleLoadModel'](){const _0x3a6536=_0x1d8aaf,_0x423ba6={'yiXdW':'green','oyKXu':_0x3a6536(0x18d),'julJf':'red','qWsox':function(_0x390656,_0x1990a1){return _0x390656(_0x1990a1);}};try{this[_0x3a6536(0x13f)]['disabled']=!![],this[_0x3a6536(0x128)][_0x3a6536(0x164)]=_0x3a6536(0x193),this['statusText'][_0x3a6536(0x1a6)][_0x3a6536(0x1a8)]=_0x3a6536(0x1a0),this['selectedModel']=this['modelSelect'][_0x3a6536(0x1a4)],console[_0x3a6536(0x156)](_0x3a6536(0x1ba)+this['selectedModel']),this['aiAdapter']=AIAdapter[_0x3a6536(0x16d)](this[_0x3a6536(0x18a)]);const _0x2cd196=await this['aiAdapter'][_0x3a6536(0x1b1)]();this['setupProgressUpdates']();if(_0x2cd196['success']){this[_0x3a6536(0x1ab)]=!![],this['selectedModel']=this['selectedModel'],this[_0x3a6536(0x128)][_0x3a6536(0x164)]=_0x3a6536(0x178)+this[_0x3a6536(0x15a)](_0x2cd196)+')',this['statusText'][_0x3a6536(0x1a6)][_0x3a6536(0x1a8)]=_0x423ba6[_0x3a6536(0x1ad)],this['statusIndicator'][_0x3a6536(0x15c)]=_0x3a6536(0x12b),this[_0x3a6536(0x13f)][_0x3a6536(0x16e)]=!![];const _0x1a6ec1=(performance[_0x3a6536(0x186)]()-this[_0x3a6536(0x16b)][_0x3a6536(0x1b6)])[_0x3a6536(0x1a2)](0x2);this['modelLoadTime'][_0x3a6536(0x164)]=_0x1a6ec1+_0x3a6536(0x12e),this[_0x3a6536(0x169)][_0x3a6536(0x164)]=this['getModelTypeDisplay'](_0x2cd196);}else this['statusText'][_0x3a6536(0x164)]=_0x3a6536(0x182)+(_0x2cd196[_0x3a6536(0x12d)]||_0x423ba6[_0x3a6536(0x1a9)]),this[_0x3a6536(0x128)]['style'][_0x3a6536(0x1a8)]=_0x423ba6[_0x3a6536(0x18e)],this[_0x3a6536(0x13f)][_0x3a6536(0x16e)]=![];}catch(_0x29ce21){this[_0x3a6536(0x128)][_0x3a6536(0x164)]='Error:\x20'+_0x29ce21['message'],this['statusText'][_0x3a6536(0x1a6)]['color']=_0x423ba6[_0x3a6536(0x18e)],this[_0x3a6536(0x13f)]['disabled']=![],console[_0x3a6536(0x12d)]('[ChatUI]\x20Model\x20load\x20error:',_0x29ce21);}finally{this[_0x3a6536(0x195)]&&(_0x423ba6[_0x3a6536(0x177)](clearInterval,this[_0x3a6536(0x195)]),this['progressUpdateInterval']=null);}}[_0x1d8aaf(0x15a)](_0x48816d){const _0x70c67=_0x1d8aaf,_0x4f548b={'NyXWC':function(_0x20bd7a,_0x210686){return _0x20bd7a===_0x210686;},'OCuAO':_0x70c67(0x158),'dfwXp':'OpenAI\x20API'};console[_0x70c67(0x156)](_0x70c67(0x15a),JSON[_0x70c67(0x180)](_0x48816d));if(!_0x48816d||!_0x48816d['modelType'])return'';if(_0x4f548b[_0x70c67(0x12c)](_0x48816d[_0x70c67(0x181)],ModelTypes[_0x70c67(0x16f)]))return _0x4f548b[_0x70c67(0x147)];else{if(_0x48816d[_0x70c67(0x181)]===ModelTypes['BROWSER_AI'])return _0x70c67(0x197);else return _0x4f548b[_0x70c67(0x12c)](_0x48816d[_0x70c67(0x181)],ModelTypes[_0x70c67(0x131)])?_0x4f548b[_0x70c67(0x157)]:'';}}[_0x1d8aaf(0x189)](_0x53c8fb){const _0x391044=_0x1d8aaf,_0x4bc5bd={'dAkNm':function(_0x5169ce,_0x3e0679){return _0x5169ce<_0x3e0679;},'jATHK':function(_0x359ab2,_0x5c2d73){return _0x359ab2%_0x5c2d73;}};return _0x4bc5bd[_0x391044(0x144)](_0x53c8fb,0x3c)?Math[_0x391044(0x188)](_0x53c8fb)+_0x391044(0x190):Math[_0x391044(0x188)](_0x53c8fb/0x3c)+'m\x20'+Math[_0x391044(0x188)](_0x4bc5bd['jATHK'](_0x53c8fb,0x3c))+_0x391044(0x190);}[_0x1d8aaf(0x15b)](_0xfeab58,_0xaa0084){const _0x1ecdf8=_0x1d8aaf,_0x4b19be={'eGAlv':function(_0x1afeff,_0x315e3e){return _0x1afeff>=_0x315e3e;},'NdoDO':function(_0x54a77e,_0x3e3d72){return _0x54a77e/_0x3e3d72;},'uwKds':function(_0x211237,_0x163e41){return _0x211237-_0x163e41;},'kVlUy':function(_0x4eed66,_0x28f849){return _0x4eed66*_0x28f849;}};if(_0xaa0084<=0x0||_0x4b19be['eGAlv'](_0xaa0084,0x1))return 0x0;const _0x29f0f8=_0x4b19be['NdoDO'](_0x4b19be['uwKds'](performance[_0x1ecdf8(0x186)](),_0xfeab58),0x3e8),_0x42cecd=_0x4b19be['NdoDO'](_0x29f0f8,_0xaa0084*0x64);return _0x42cecd*(0x64-_0x4b19be[_0x1ecdf8(0x170)](_0xaa0084,0x64));}[_0x1d8aaf(0x136)](){const _0x50ce20={'tsUOF':function(_0x43f320,_0x56296e){return _0x43f320>_0x56296e;},'iBSmn':function(_0x46f4ca,_0x19d8ed){return _0x46f4ca<_0x19d8ed;},'Oizfl':function(_0x1c4191,_0x3aa59b){return _0x1c4191(_0x3aa59b);},'OYQnE':function(_0x2a4678,_0x584457){return _0x2a4678(_0x584457);}};this['progressUpdateInterval']&&_0x50ce20['OYQnE'](clearInterval,this['progressUpdateInterval']),this['progressUpdateInterval']=setInterval(()=>{const _0x4ec6f1=_0x41b5;if(this[_0x4ec6f1(0x16b)]){const _0x2bda31=this[_0x4ec6f1(0x16b)][_0x4ec6f1(0x12f)],_0x46c03b=this[_0x4ec6f1(0x16b)][_0x4ec6f1(0x18f)];if(_0x50ce20['tsUOF'](_0x2bda31,0x0)&&_0x50ce20['iBSmn'](_0x2bda31,0x64)){const _0x1a3db0=this[_0x4ec6f1(0x16b)][_0x4ec6f1(0x166)][_0x4ec6f1(0x16a)];let _0x4f1593=_0x4ec6f1(0x145)+Math[_0x4ec6f1(0x1ae)](_0x2bda31)+'%';_0x1a3db0&&_0x1a3db0>0x0&&(_0x4f1593+='\x20('+this[_0x4ec6f1(0x189)](_0x1a3db0)+')'),_0x46c03b&&(_0x4f1593+=_0x4ec6f1(0x134)+_0x46c03b),this[_0x4ec6f1(0x128)][_0x4ec6f1(0x164)]=_0x4f1593;}else _0x46c03b&&(this[_0x4ec6f1(0x128)][_0x4ec6f1(0x164)]=_0x46c03b);(_0x2bda31>=0x64||this['aiAdapter']['isInitialized'])&&(_0x50ce20[_0x4ec6f1(0x154)](clearInterval,this[_0x4ec6f1(0x195)]),this[_0x4ec6f1(0x195)]=null);}},0xc8);}['cleanup'](){const _0x4d4a01=_0x1d8aaf,_0x57cb22={'VEfDM':function(_0x397015,_0x28c52e){return _0x397015(_0x28c52e);}};this[_0x4d4a01(0x195)]&&(_0x57cb22[_0x4d4a01(0x198)](clearInterval,this['progressUpdateInterval']),this['progressUpdateInterval']=null),this[_0x4d4a01(0x16b)]&&(this[_0x4d4a01(0x16b)][_0x4d4a01(0x179)](),this[_0x4d4a01(0x16b)]=null);}}