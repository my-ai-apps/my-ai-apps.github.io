
/*!
Copyright ¬© 2024 Saisha Pandit. All Rights Reserved.
Unauthorized use, modification, or distribution is strictly prohibited.
*/
const _0x4413ef=_0x1c25;(function(_0x4dde53,_0x5154c5){const _0x357eb8=_0x1c25,_0x473c39=_0x4dde53();while(!![]){try{const _0x721324=-parseInt(_0x357eb8(0x17e))/0x1*(-parseInt(_0x357eb8(0x1d4))/0x2)+-parseInt(_0x357eb8(0x169))/0x3+parseInt(_0x357eb8(0x1a4))/0x4*(-parseInt(_0x357eb8(0x17f))/0x5)+-parseInt(_0x357eb8(0x1c4))/0x6*(parseInt(_0x357eb8(0x1f6))/0x7)+parseInt(_0x357eb8(0x195))/0x8*(-parseInt(_0x357eb8(0x211))/0x9)+parseInt(_0x357eb8(0x1fc))/0xa+parseInt(_0x357eb8(0x1f8))/0xb;if(_0x721324===_0x5154c5)break;else _0x473c39['push'](_0x473c39['shift']());}catch(_0x408f2e){_0x473c39['push'](_0x473c39['shift']());}}}(_0x487a,0xe10ba));import{CreateMLCEngine,CreateWebWorkerMLCEngine,modelLibURLPrefix,modelVersion,prebuiltAppConfig}from'https://esm.run/@mlc-ai/web-llm';import*as _0x440d9f from'https://esm.run/@mlc-ai/web-llm';import{MLCModelCacheManager}from'./mlcModelCacheManager.js';function _0x487a(){const _0x5a39d6=['4234551cfLcIr','startsWith','completions','‚è∞\x20[MLCEngine]\x20Worker\x20initialization\x20timeout','split','dispatchProgressEvent','Bytes','worker','===\x20MLC\x20MODEL\x20CACHE\x20INFORMATION\x20===','tOkPh','_mlcLoadModelOptions','dispose','\x20of\x20','error','AwLZf','lRMHR','system_prompt','content','‚ö†Ô∏è\x20[MLCEngine]\x20Model\x20is\x20already\x20loading\x20or\x20loaded.','https://huggingface.co/','terminate','1701578Bnlbls','185xThBHh','some','FycGm','vaAOB','dispatchStatusEvent','success','appConfig','jRrYo','response_format','clearModelCache','üéâ[MLCEngine]:\x20Model\x20loaded\x20successfully!','isArray','all','KFNOy','Total\x20cache\x20size:\x20','HxZko','_loadingInProgress','embeddings','loading','getCacheInfo','modelLibrary','{quantization}','928pvGqMi','aBAPN','quantization','ONtcu','info','http','loadModel','stringify','üåê\x20MLCEngineWrapper\x20Worker\x20Script\x20Loaded','Number\x20of\x20models:\x20','7|3|4|5|2|6|1|0','[MLCEngine]\x20generateResponseStream\x20input:\x20','auto','clearSpecificModel','xagiP','133724WVdCuE','[MLCEngine]üì¶\x20Creating\x20new\x20Worker','createObjectURL','module','user','ZSRqD','ARbsQ','\x0a\x20\x20//\x20Ensure\x20we\x27re\x20in\x20a\x20worker\x20context\x0a\x20\x20if\x20(typeof\x20self\x20===\x20\x27undefined\x27)\x20{\x0a\x20\x20\x20\x20throw\x20new\x20Error(\x27This\x20script\x20must\x20be\x20run\x20in\x20a\x20Web\x20Worker\x27);\x0a\x20\x20}\x0a\x0a\x20\x20console.log(\x27[Worker]\x20Starting\x20initialization...\x27);\x0a\x0a\x20\x20//\x20Wrap\x20the\x20entire\x20worker\x20code\x20in\x20a\x20try-catch\x0a\x20\x20try\x20{\x0a\x20\x20\x20\x20//\x20Wait\x20for\x20the\x20main\x20thread\x20to\x20send\x20us\x20the\x20module\x20URL\x0a\x20\x20\x20\x20self.onmessage\x20=\x20async\x20(msg)\x20=>\x20{\x0a\x20\x20\x20\x20\x20\x20if\x20(msg.data.type\x20===\x20\x27init\x27)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20console.log(\x27üöÄ\x20[Worker]\x20Received\x20init\x20message\x20with\x20moduleURL:\x20\x27\x20+\x20msg.data.moduleURL);\x0a\x20\x20\x20\x20\x20\x20\x20\x20const\x20moduleURL\x20=\x20msg.data.moduleURL;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20try\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20const\x20module\x20=\x20await\x20import(moduleURL);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20console.log(\x27[Worker]\x20Module\x20loaded\x20successfully\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20const\x20handler\x20=\x20new\x20module.WebWorkerMLCEngineHandler();\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20//\x20Replace\x20onmessage\x20handler\x20with\x20the\x20actual\x20handler\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20self.onmessage\x20=\x20(msg)\x20=>\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20console.log(\x27üöÄ\x20[Worker]\x20Received\x20message:\x27,\x20msg.data);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20try\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20handler.onmessage(msg);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x20catch\x20(error)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20console.error(\x27[Worker]\x20Handler\x20error:\x27,\x20error);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20self.postMessage({\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20type:\x20\x27error\x27,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20error:\x20error\x20instanceof\x20Error\x20?\x20error.message\x20:\x20String(error)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20});\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20};\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20self.postMessage({\x20type:\x20\x27ready\x27\x20});\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20console.log(\x27üöÄ\x20[Worker]\x20Handler\x20initialized\x20successfully\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x20catch\x20(error)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20console.error(\x27[Worker]\x20Failed\x20to\x20load\x20module:\x27,\x20error);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20self.postMessage({\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20type:\x20\x27error\x27,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20error:\x20\x27Failed\x20to\x20initialize\x20worker:\x20\x27\x20+\x20(error\x20instanceof\x20Error\x20?\x20error.message\x20:\x20String(error))\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20});\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20};\x0a\x20\x20}\x20catch\x20(error)\x20{\x0a\x20\x20\x20\x20console.error(\x27[Worker]\x20Initialization\x20error:\x27,\x20error);\x0a\x20\x20\x20\x20self.postMessage({\x0a\x20\x20\x20\x20\x20\x20type:\x20\x27error\x27,\x0a\x20\x20\x20\x20\x20\x20error:\x20\x27Worker\x20initialization\x20failed:\x20\x27\x20+\x20(error\x20instanceof\x20Error\x20?\x20error.message\x20:\x20String(error))\x0a\x20\x20\x20\x20});\x0a\x20\x20}\x0a\x0a\x20\x20self.onerror\x20=\x20(error)\x20=>\x20{\x0a\x20\x20\x20\x20console.error(\x27[Worker]\x20Global\x20error:\x27,\x20error);\x0a\x20\x20\x20\x20self.postMessage({\x0a\x20\x20\x20\x20\x20\x20type:\x20\x27error\x27,\x0a\x20\x20\x20\x20\x20\x20error:\x20error\x20instanceof\x20ErrorEvent\x20?\x20error.message\x20:\x20\x27Unknown\x20worker\x20error\x27\x0a\x20\x20\x20\x20});\x0a\x20\x20};\x0a\x0a\x20\x20self.onmessageerror\x20=\x20(error)\x20=>\x20{\x0a\x20\x20\x20\x20console.error(\x27[Worker]\x20Message\x20error:\x27,\x20error);\x0a\x20\x20\x20\x20self.postMessage({\x0a\x20\x20\x20\x20\x20\x20type:\x20\x27error\x27,\x0a\x20\x20\x20\x20\x20\x20error:\x20\x27Message\x20error:\x20\x27\x20+\x20(error\x20instanceof\x20Error\x20?\x20error.message\x20:\x20String(error))\x0a\x20\x20\x20\x20});\x0a\x20\x20};\x0a\x20\x20\x0a\x20\x20//\x20Signal\x20that\x20the\x20worker\x20is\x20ready\x0a\x20\x20console.log(\x27‚úÖ\x20\x20[Worker]\x20Worker\x20is\x20READY\x20-\x20Basic\x20initialization\x20complete\x27);\x0a\x20\x20//\x20self.postMessage({\x20status:\x20\x22ready\x22,\x20message:\x20\x22[Worker]\x20Worker\x20is\x20ready.\x20Basic\x20initialization\x20complete\x22\x20});\x0a','json_object','xnpEo','[MLCEngine]\x20Worker\x20message\x20error:','json_schema','ZFfsx','0\x20Bytes','https://esm.run/@mlc-ai/web-llm','toFixed','[MLCEngine]\x20Loading\x20model:\x20','filter','mHxbL','progress','‚ùå\x20[MLCEngine]\x20Worker\x20Creation\x20error:','webllm/wasm','XNnsT','formatBytes','xoVdI','replace','xmvwD','yqaxo','mZDZG','Model\x20sizes\x20map\x20length:\x20','AUOwN','lgqym','80286xkpJrr','gemma-2b-it-q4f32_1','xihfd','jYozo','with\x20worker:','touchModel','MNRlO','CSaTR','Taeqb','oqCzf','with\x20quantization:','arYUd','start','defaultQuantization','XyjIH','time','2afxNnr','AVDpR','url','stream_options','Model\x20queue\x20length:\x20','isModelCached','PHcnC','modelQueueLength','[MLCEngine:loadModule]\x20Using\x20module\x20URL:','NDDmU','CtTGP','[MLCEngine]\x20Successfully\x20cleared\x20MLC\x20model\x20cache','chat','[MLCEngine:loadModule]\x20Using\x20module\x20name\x20as\x20fallback\x20for\x20CJS\x20environment','[MLCEngine]\x20MLC\x20Engine\x20not\x20initialized.','generateText','IjNkN','forEach','cMkRx','KSppO','onerror','push','message','pow','getInstance','onProgress','You\x20must\x20respond\x20with\x20valid\x20JSON\x20that\x20matches\x20the\x20provided\x20schema.\x20Do\x20not\x20include\x20any\x20explanations\x20or\x20additional\x20text.\x0a\x0a','üîç\x20MLCEngineWrapper\x20Library:','qRfXc','position','data','[MLCEngine]\x20Loading\x20model:','[MLCEngine]\x20Worker\x20not\x20initialized','log','672ACxeof','ready','34857493SciJQJ','modelPath','usedPercent','type','4858530XHiSIl','floor','keys','choices','useWorker','cacheManager','IFaws','üì¨\x20[Worker\x20Status]\x20','EaONM','onmessage','mlc-worker','postMessage','repo','string','debug','OZrLW','isModelLoaded','loUxp','BryaP','revokeObjectURL','system','38907dLXWXu','ApbCs','totalSize','stream','create','[MLCEngine]\x20Load\x20error:','[Worker\x20Status]\x20','nChRl','mlcEngine','IdQco','_modelLoaded','ZROeS','phxCY','AtcKG','map'];_0x487a=function(){return _0x5a39d6;};return _0x487a();}console[_0x4413ef(0x1f5)](_0x4413ef(0x19d)),console[_0x4413ef(0x1f5)](_0x4413ef(0x1ef));const defaultModelName='tinyllama-1.1b-chat-v0.4';function _0x1c25(_0x27a7fc,_0x560153){const _0x487a90=_0x487a();return _0x1c25=function(_0x1c2569,_0x255b15){_0x1c2569=_0x1c2569-0x163;let _0x526b5c=_0x487a90[_0x1c2569];return _0x526b5c;},_0x1c25(_0x27a7fc,_0x560153);}export class MLCEngineWrapper{constructor(_0x4098e6,_0x216e2f={}){const _0xba16eb=_0x4413ef,_0x398e4=_0xba16eb(0x19f)[_0xba16eb(0x16d)]('|');let _0x1fcd37=0x0;while(!![]){switch(_0x398e4[_0x1fcd37++]){case'0':this[_0xba16eb(0x173)]=_0x216e2f;continue;case'1':this[_0xba16eb(0x164)]=![];continue;case'2':this[_0xba16eb(0x201)]=MLCModelCacheManager[_0xba16eb(0x1ec)]();continue;case'3':this[_0xba16eb(0x185)]=null;continue;case'4':this['modelConfig']=_0x4098e6;continue;case'5':this[_0xba16eb(0x170)]=null;continue;case'6':this[_0xba16eb(0x18f)]=![];continue;case'7':this['mlcEngine']=null;continue;}break;}}async[_0x4413ef(0x19b)](_0x359b51,_0x1188e5={}){const _0x2a4b36=_0x4413ef,_0xf8877d={'IdQco':_0x2a4b36(0x1b8),'aBAPN':function(_0x5df345,_0x397bc4){return _0x5df345(_0x397bc4);},'arYUd':_0x2a4b36(0x1f7),'cMkRx':function(_0x360246,_0x15cbc0){return _0x360246(_0x15cbc0);},'AVDpR':function(_0x27d69b){return _0x27d69b();},'xagiP':'error','jiyOf':function(_0x555f7b,_0x3dc1c5){return _0x555f7b(_0x3dc1c5);},'CSaTR':function(_0x3023fa,_0x19a969){return _0x3023fa(_0x19a969);},'ZSRqD':_0x2a4b36(0x1f4),'jRrYo':function(_0x58281b,_0x40dbc0,_0x3de870){return _0x58281b(_0x40dbc0,_0x3de870);},'ApbCs':_0x2a4b36(0x1dc),'OZrLW':'@mlc-ai/web-llm','UcFoV':_0x2a4b36(0x1e1),'qRfXc':'init','dqbiz':_0x2a4b36(0x199),'iQBcv':_0x2a4b36(0x191),'yqaxo':_0x2a4b36(0x1a1),'PHcnC':'text/javascript','mZDZG':'[MLCEngine]\x20WorkerInitializationTime','ONtcu':_0x2a4b36(0x1a7),'tOkPh':_0x2a4b36(0x206),'FycGm':_0x2a4b36(0x1ce),'nChRl':function(_0x32f7be,_0x1dbadf){return _0x32f7be+_0x1dbadf;},'AtcKG':_0x2a4b36(0x17c),'tafbV':'{quantization}','xmvwD':_0x2a4b36(0x19a),'lgqym':function(_0x532814,_0x2dd57e){return _0x532814+_0x2dd57e;},'HxZko':function(_0x2b7b3d,_0x11192d,_0x53c16d,_0xe1308d){return _0x2b7b3d(_0x11192d,_0x53c16d,_0xe1308d);},'jYozo':function(_0x46b374,_0xe00d29,_0x1cadbe){return _0x46b374(_0xe00d29,_0x1cadbe);},'IFaws':_0x2a4b36(0x184),'loUxp':_0x2a4b36(0x189),'yaYlB':function(_0xf388cf,_0x3b0b06){return _0xf388cf instanceof _0x3b0b06;},'lRMHR':_0x2a4b36(0x216)};if(this[_0x2a4b36(0x18f)]||this[_0x2a4b36(0x164)]){this[_0x2a4b36(0x183)](_0xf8877d['dqbiz'],_0x2a4b36(0x17b));return;}this[_0x2a4b36(0x18f)]=!![],this[_0x2a4b36(0x183)](_0xf8877d['iQBcv'],_0x2a4b36(0x1b4)+this['modelConfig']),this[_0x2a4b36(0x164)]=![];const {quantized:quantized=!![],device:device=_0xf8877d[_0x2a4b36(0x1bf)],modelPath:modelPath=null,contextWindowSize:contextWindowSize=0x1000,systemPrompt:systemPrompt='',temperature:temperature=0.7,maxGenLength:maxGenLength=0x400,..._0xadca8}=_0x1188e5;this['modelConfig']=_0x359b51;const _0x193ac3={'model':_0x359b51[_0x2a4b36(0x1f9)]||modelPath};try{this[_0x2a4b36(0x170)]&&(this[_0x2a4b36(0x170)]['terminate'](),this[_0x2a4b36(0x170)]=null);if(_0x1188e5[_0x2a4b36(0x200)]){const _0x107b4b=new Blob([workerCode],{'type':_0xf8877d[_0x2a4b36(0x1da)]}),_0x5cb0d1=URL[_0x2a4b36(0x1a6)](_0x107b4b);console[_0x2a4b36(0x1f5)](_0x2a4b36(0x1a5)),console[_0x2a4b36(0x1d3)](_0xf8877d[_0x2a4b36(0x1c0)]),this[_0x2a4b36(0x170)]=new Worker(_0x5cb0d1,{'type':_0xf8877d[_0x2a4b36(0x198)],'name':_0xf8877d[_0x2a4b36(0x172)]}),URL[_0x2a4b36(0x20f)](_0x5cb0d1),this['worker'][_0x2a4b36(0x1e8)]=_0x1d7322=>{const _0x942679=_0x2a4b36;console[_0x942679(0x176)](_0xf8877d[_0x942679(0x163)],_0x1d7322),this[_0x942679(0x18f)]=![];throw new Error('[MLCEngine]\x20Worker\x20error:\x20'+_0x1d7322[_0x942679(0x1ea)]);},this[_0x2a4b36(0x170)]['onmessageerror']=_0x54ff3d=>{const _0x2469af=_0x2a4b36;console['error'](_0x2469af(0x1ae),_0x54ff3d);},await new Promise((_0x5d8933,_0x1db50b)=>{const _0x1112e5=_0x2a4b36,_0x20587c={'ZiuFu':function(_0x29390d,_0xd44962){const _0x37c4c6=_0x1c25;return _0xf8877d[_0x37c4c6(0x196)](_0x29390d,_0xd44962);},'tmBgs':_0xf8877d[_0x1112e5(0x1cf)],'ZROeS':function(_0xc747a8,_0x460cb7){const _0x5d165d=_0x1112e5;return _0xf8877d[_0x5d165d(0x1e6)](_0xc747a8,_0x460cb7);},'ELjqW':function(_0x57a7ac){const _0x5a5b84=_0x1112e5;return _0xf8877d[_0x5a5b84(0x1d5)](_0x57a7ac);},'AwLZf':function(_0x36ec81,_0x47f92b){return _0x36ec81===_0x47f92b;},'PvPca':_0xf8877d[_0x1112e5(0x1a3)],'vaAOB':function(_0x1fb247,_0x34a794){return _0xf8877d['jiyOf'](_0x1fb247,_0x34a794);}};if(!this['worker'])return _0xf8877d[_0x1112e5(0x1cb)](_0x1db50b,new Error(_0xf8877d[_0x1112e5(0x1a9)]));const _0x215370=_0xf8877d[_0x1112e5(0x186)](setTimeout,()=>{const _0x57834c=_0x1112e5;_0x20587c['ZiuFu'](_0x1db50b,new Error(_0x57834c(0x16c)));},0x2710);this[_0x1112e5(0x170)][_0x1112e5(0x205)]=_0x32299a=>{const _0x3368c8=_0x1112e5;if(_0x32299a[_0x3368c8(0x1f2)][_0x3368c8(0x1fb)]===_0x20587c['tmBgs'])_0x20587c[_0x3368c8(0x165)](clearTimeout,_0x215370),_0x20587c['ELjqW'](_0x5d8933);else _0x20587c[_0x3368c8(0x177)](_0x32299a[_0x3368c8(0x1f2)][_0x3368c8(0x1fb)],_0x20587c['PvPca'])&&(_0x20587c[_0x3368c8(0x182)](clearTimeout,_0x215370),_0x1db50b(new Error(_0x32299a[_0x3368c8(0x1f2)][_0x3368c8(0x176)])));};let _0xa0675a;try{_0xa0675a=new URL(_0x1112e5(0x1b2),import.meta[_0x1112e5(0x1d6)])['href'],console[_0x1112e5(0x1f5)](_0xf8877d[_0x1112e5(0x212)],_0xa0675a);}catch(_0x26030e){_0xa0675a=_0xf8877d[_0x1112e5(0x20b)],console[_0x1112e5(0x1f5)](_0xf8877d['UcFoV']);}this[_0x1112e5(0x16e)](_0x1112e5(0x1d0),0x0),this['worker']['postMessage']({'type':_0xf8877d[_0x1112e5(0x1f0)],'moduleURL':_0xa0675a});});}const _0x383393=_0x1188e5[_0x2a4b36(0x197)]||_0x359b51[_0x2a4b36(0x1d1)],_0x52cb30=_0x359b51[_0x2a4b36(0x208)]?_0x359b51[_0x2a4b36(0x208)][_0x2a4b36(0x1bd)](_0x2a4b36(0x194),_0x383393)[_0x2a4b36(0x16d)]('/')[0x1]:_0x2a4b36(0x1c5);return this[_0x2a4b36(0x201)][_0x2a4b36(0x1c9)](_0x52cb30),console[_0x2a4b36(0x1f5)](_0x2a4b36(0x1f3),_0x52cb30,_0xf8877d[_0x2a4b36(0x181)],_0x383393,_0x2a4b36(0x1c8),!!this[_0x2a4b36(0x170)]),_0x359b51[_0x2a4b36(0x193)]?this[_0x2a4b36(0x185)]={'model_list':[{'model':_0xf8877d[_0x2a4b36(0x218)](_0xf8877d[_0x2a4b36(0x167)],_0x359b51[_0x2a4b36(0x208)][_0x2a4b36(0x1bd)](_0xf8877d['tafbV'],_0x383393)),'model_id':_0x52cb30,'model_lib':_0x359b51?.[_0x2a4b36(0x193)]?.[_0x2a4b36(0x16a)](_0xf8877d[_0x2a4b36(0x1be)])?_0x359b51[_0x2a4b36(0x193)]:_0xf8877d[_0x2a4b36(0x1c3)](_0xf8877d[_0x2a4b36(0x1c3)](_0xf8877d[_0x2a4b36(0x218)](modelLibURLPrefix,'/'),modelVersion),'/')+_0x359b51[_0x2a4b36(0x193)]}]}:this[_0x2a4b36(0x185)]=prebuiltAppConfig,this['worker']?this[_0x2a4b36(0x219)]=await _0xf8877d[_0x2a4b36(0x18e)](CreateWebWorkerMLCEngine,this['worker'],_0x52cb30,{'initProgressCallback':_0xa69cc7=>{_0x1188e5['onProgress']?.(_0xa69cc7);},'appConfig':this[_0x2a4b36(0x185)],..._0x1188e5}):this[_0x2a4b36(0x219)]=await _0xf8877d[_0x2a4b36(0x1c7)](CreateMLCEngine,_0x52cb30,{'initProgressCallback':_0x1188e5[_0x2a4b36(0x1ed)],'appConfig':this[_0x2a4b36(0x185)],..._0x1188e5}),this['_modelLoaded']=!![],this['_loadingInProgress']=![],this[_0x2a4b36(0x183)](_0xf8877d[_0x2a4b36(0x202)],_0xf8877d[_0x2a4b36(0x20d)]),!![];}catch(_0x117921){this[_0x2a4b36(0x170)]&&(this['worker'][_0x2a4b36(0x17d)](),this['worker']=null);const _0x5df8c1=_0xf8877d['yaYlB'](_0x117921,Error)?_0x117921[_0x2a4b36(0x1ea)]:_0xf8877d['jiyOf'](String,_0x117921);return this[_0x2a4b36(0x164)]=![],this[_0x2a4b36(0x18f)]=![],this['dispatchStatusEvent']('error',_0x5df8c1),console['error'](_0xf8877d[_0x2a4b36(0x178)],_0x117921),![];}}[_0x4413ef(0x183)](_0x25418a,_0x12d25d){const _0x473fdf=_0x4413ef;console[_0x473fdf(0x1f5)](_0x473fdf(0x203)+_0x25418a+':\x20'+_0x12d25d),self[_0x473fdf(0x207)]({'status':_0x25418a,'message':_0x12d25d});}[_0x4413ef(0x16e)](_0x1d7bc4,_0x4b4476){const _0x239662=_0x4413ef,_0x284938={'ZFfsx':_0x239662(0x1b7)};console[_0x239662(0x1f5)](_0x239662(0x217)+_0x1d7bc4+':\x20'+_0x4b4476+'%'),self[_0x239662(0x207)]({'status':_0x284938[_0x239662(0x1b0)],'stage':_0x1d7bc4,'progress':_0x4b4476});}[_0x4413ef(0x20c)](){const _0x18391e=_0x4413ef,_0x3bf8c1={'tZrbD':function(_0x2c17ae,_0x5c4d38){return _0x2c17ae===_0x5c4d38;}};return _0x3bf8c1['tZrbD'](this[_0x18391e(0x164)],!![]);}[_0x4413ef(0x1d9)](){const _0x26a46d=_0x4413ef,_0x255636={'KFNOy':function(_0x4c661c,_0x432234){return _0x4c661c===_0x432234;}};return _0x255636[_0x26a46d(0x18c)](this[_0x26a46d(0x201)]['isModelCached'](this['modelIdentifier']),!![]);}async[_0x4413ef(0x1e3)](_0x53676c,_0x70f14={}){const _0x144465=_0x4413ef,_0x1b4121={'phxCY':'[MLCEngine]\x20MLC\x20Engine\x20not\x20initialized.','MNRlO':'You\x20must\x20respond\x20with\x20valid\x20JSON\x20that\x20matches\x20the\x20provided\x20schema.\x20Do\x20not\x20include\x20any\x20explanations\x20or\x20additional\x20text.\x0a\x0a','xoVdI':_0x144465(0x210),'CtTGP':_0x144465(0x1a8),'XNnsT':function(_0x59628b,_0x3ee043){return _0x59628b===_0x3ee043;},'oqCzf':_0x144465(0x209),'XyjIH':_0x144465(0x1ac)};if(!this[_0x144465(0x219)])throw new Error(_0x1b4121[_0x144465(0x166)]);let _0x36484d=[],_0x221f5c='';_0x70f14['json_schema']&&(_0x221f5c+=_0x1b4121[_0x144465(0x1ca)]);_0x70f14[_0x144465(0x179)]&&(_0x221f5c+=_0x70f14[_0x144465(0x179)]);_0x221f5c&&_0x36484d[_0x144465(0x1e9)]({'role':_0x1b4121[_0x144465(0x1bc)],'content':_0x221f5c['trim']()});Array[_0x144465(0x18a)](_0x53676c)?_0x36484d[_0x144465(0x1e9)](..._0x53676c):_0x36484d[_0x144465(0x1e9)]({'role':_0x1b4121[_0x144465(0x1de)],'content':_0x53676c});const _0x1d7785={'max_tokens':0x12c,'temperature':0.6,'top_p':0.95,'frequency_penalty':0.5,'presence_penalty':0.5};if(_0x70f14[_0x144465(0x1af)]){const _0x1e0021=_0x1b4121[_0x144465(0x1ba)](typeof _0x70f14[_0x144465(0x1af)],_0x1b4121[_0x144465(0x1cd)])?_0x70f14['json_schema']:JSON[_0x144465(0x19c)](_0x70f14['json_schema']);_0x70f14[_0x144465(0x187)]={'type':_0x1b4121[_0x144465(0x1d2)],'schema':_0x1e0021};}const _0x20a2c6={..._0x1d7785,..._0x70f14,'messages':_0x36484d};if(_0x70f14['stream'])return _0x20a2c6[_0x144465(0x1d7)]={'include_usage':!![]},this[_0x144465(0x219)][_0x144465(0x1e0)]['completions'][_0x144465(0x215)](_0x20a2c6);const _0x35975f=await this['mlcEngine'][_0x144465(0x1e0)][_0x144465(0x16b)][_0x144465(0x215)](_0x20a2c6);return _0x35975f[_0x144465(0x1ff)][0x0]['message'][_0x144465(0x17a)];}async['generateResponseStream'](_0x130c54,_0x46f825={}){const _0x2f029a=_0x4413ef,_0xafae4a={'bpQQO':_0x2f029a(0x1e2),'xihfd':_0x2f029a(0x1ee),'EaONM':_0x2f029a(0x210),'FoTJF':'user','mHxbL':function(_0x167d41,_0x2905bf){return _0x167d41===_0x2905bf;},'IIEIt':_0x2f029a(0x209),'AbHGO':_0x2f029a(0x1ac)};if(!this[_0x2f029a(0x219)])throw new Error(_0xafae4a['bpQQO']);console[_0x2f029a(0x1f5)](_0x2f029a(0x1a0),_0x130c54,_0x46f825);let _0x3154ea=[],_0x380f9b='';_0x46f825[_0x2f029a(0x1af)]&&(_0x380f9b+=_0xafae4a[_0x2f029a(0x1c6)]);_0x46f825[_0x2f029a(0x179)]&&(_0x380f9b+=_0x46f825[_0x2f029a(0x179)]);_0x380f9b&&_0x3154ea['push']({'role':_0xafae4a[_0x2f029a(0x204)],'content':_0x380f9b['trim']()});Array[_0x2f029a(0x18a)](_0x130c54)?_0x3154ea[_0x2f029a(0x1e9)](..._0x130c54):_0x3154ea[_0x2f029a(0x1e9)]({'role':_0xafae4a['FoTJF'],'content':_0x130c54});const _0x5c138e={'max_tokens':0x12c,'temperature':0.6,'top_p':0.95,'frequency_penalty':0.5,'presence_penalty':0.5,'stream':!![]};if(_0x46f825[_0x2f029a(0x1af)]){const _0x4cb6ff=_0xafae4a[_0x2f029a(0x1b6)](typeof _0x46f825[_0x2f029a(0x1af)],_0xafae4a['IIEIt'])?_0x46f825[_0x2f029a(0x1af)]:JSON['stringify'](_0x46f825[_0x2f029a(0x1af)]);_0x46f825['response_format']={'type':_0xafae4a['AbHGO'],'schema':_0x4cb6ff};}const _0xaf78d={..._0x5c138e,..._0x46f825,'messages':_0x3154ea};return _0xaf78d[_0x2f029a(0x214)]=!![],_0xaf78d[_0x2f029a(0x1d7)]={'include_usage':!![]},this[_0x2f029a(0x219)][_0x2f029a(0x1e0)][_0x2f029a(0x16b)][_0x2f029a(0x215)](_0xaf78d);}async['embed'](_0x3709f6,_0x574295={}){const _0x15194e=_0x4413ef,_0x290d53={'AUOwN':'[MLCEngine]\x20MLC\x20Engine\x20not\x20initialized.'};if(!this['mlcEngine'])throw new Error(_0x290d53[_0x15194e(0x1c2)]);const _0x40d7bd=await this['mlcEngine'][_0x15194e(0x190)][_0x15194e(0x215)]({'input':_0x3709f6,..._0x574295});return _0x40d7bd[_0x15194e(0x1f2)][0x0]['embedding'];}[_0x4413ef(0x174)](){const _0x44dc3c=_0x4413ef;this[_0x44dc3c(0x170)]&&(this[_0x44dc3c(0x170)][_0x44dc3c(0x17d)](),this[_0x44dc3c(0x170)]=null),this[_0x44dc3c(0x219)]=null;}async[_0x4413ef(0x188)](){const _0x6eb1a2=_0x4413ef,_0x25aacf={'TUIvj':_0x6eb1a2(0x1b9),'ARbsQ':'webllm/model','ZExhE':_0x6eb1a2(0x1df),'CteLd':function(_0x3b7209){return _0x3b7209();}};return new Promise(async(_0xf6aa80,_0x52a93e)=>{const _0x314adb=_0x6eb1a2;try{const _0x46b1d1=['webllm/config',_0x25aacf['TUIvj'],_0x25aacf[_0x314adb(0x1aa)]],_0x382a07=await caches[_0x314adb(0x1fe)](),_0x519bbc=_0x382a07[_0x314adb(0x1b5)](_0x289e30=>_0x46b1d1[_0x314adb(0x180)](_0xc9e78f=>_0x289e30['includes'](_0xc9e78f)));await Promise[_0x314adb(0x18b)](_0x519bbc[_0x314adb(0x168)](_0x2d5198=>caches['delete'](_0x2d5198))),console['log'](_0x25aacf['ZExhE']),_0x25aacf['CteLd'](_0xf6aa80);}catch(_0x53c8e7){console[_0x314adb(0x176)]('[MLCEngine]\x20Error\x20clearing\x20model\x20cache:',_0x53c8e7),_0x52a93e(_0x53c8e7);}});}async[_0x4413ef(0x1a2)](_0x3c73e8){const _0x126f05={'AhWZd':'[MLCEngine]\x20Model\x20identifier\x20is\x20required'};if(!_0x3c73e8)throw new Error(_0x126f05['AhWZd']);return this['cacheManager']['removeModelFromCache'](_0x3c73e8);}async[_0x4413ef(0x192)](){const _0x5d4c9d=_0x4413ef;return this['cacheManager'][_0x5d4c9d(0x192)]();}async['printCacheInfo'](){const _0x6310c7=_0x4413ef,_0x23fca7={'KSppO':'\x0aModels\x20by\x20LRU\x20order\x20(most\x20recently\x20used\x20last):','IjNkN':'\x0aDebug\x20info:'},_0x53b7af=await this[_0x6310c7(0x201)]['getCacheInfo']();console['log'](_0x6310c7(0x171)),console['log'](_0x6310c7(0x18d)+this[_0x6310c7(0x1bb)](_0x53b7af[_0x6310c7(0x213)])+_0x6310c7(0x175)+this[_0x6310c7(0x1bb)](_0x53b7af['maxSize'])+'\x20('+_0x53b7af[_0x6310c7(0x1fa)][_0x6310c7(0x1b3)](0x2)+'%)'),console[_0x6310c7(0x1f5)](_0x6310c7(0x19e)+_0x53b7af['models']['length']),console[_0x6310c7(0x1f5)](_0x23fca7[_0x6310c7(0x1e7)]);const _0x19a7fd=[..._0x53b7af['models']]['sort']((_0x2cfe18,_0xab91e7)=>_0x2cfe18[_0x6310c7(0x1f1)]-_0xab91e7[_0x6310c7(0x1f1)]);_0x19a7fd[_0x6310c7(0x1e5)]((_0x1b6a19,_0x264c76)=>{const _0x139cc1=_0x6310c7;console['log'](_0x264c76+0x1+'.\x20'+_0x1b6a19['id']+':\x20'+this[_0x139cc1(0x1bb)](_0x1b6a19['size']));}),console[_0x6310c7(0x1f5)](_0x23fca7[_0x6310c7(0x1e4)]),console[_0x6310c7(0x1f5)](_0x6310c7(0x1d8)+_0x53b7af[_0x6310c7(0x20a)][_0x6310c7(0x1db)]),console[_0x6310c7(0x1f5)](_0x6310c7(0x1c1)+_0x53b7af[_0x6310c7(0x20a)]['modelSizesLength']),console[_0x6310c7(0x1f5)]('LRU\x20Queue\x20order:',_0x53b7af['debug']['modelQueue']);}['formatBytes'](_0x49b5fb){const _0x60196b=_0x4413ef,_0x58a853={'BryaP':function(_0x4e5186,_0xd49764){return _0x4e5186===_0xd49764;},'Taeqb':_0x60196b(0x1b1),'FMHvW':_0x60196b(0x16f),'NDDmU':function(_0x485076,_0x24bb8e){return _0x485076/_0x24bb8e;},'xnpEo':function(_0x51ac26,_0x5a53e1){return _0x51ac26+_0x5a53e1;},'GwKHA':function(_0x3b904a,_0x9d29e2){return _0x3b904a(_0x9d29e2);}};if(_0x58a853[_0x60196b(0x20e)](_0x49b5fb,0x0))return _0x58a853[_0x60196b(0x1cc)];const _0x408bc9=0x400,_0x591562=[_0x58a853['FMHvW'],'KB','MB','GB','TB'],_0x373388=Math[_0x60196b(0x1fd)](_0x58a853[_0x60196b(0x1dd)](Math[_0x60196b(0x1f5)](_0x49b5fb),Math['log'](_0x408bc9)));return _0x58a853[_0x60196b(0x1ad)](_0x58a853['GwKHA'](parseFloat,(_0x49b5fb/Math[_0x60196b(0x1eb)](_0x408bc9,_0x373388))['toFixed'](0x2))+'\x20',_0x591562[_0x373388]);}}const workerCode=_0x4413ef(0x1ab);