
/*!
Copyright Â© 2024 Saisha Pandit. All Rights Reserved.
Unauthorized use, modification, or distribution is strictly prohibited.
*/
const _0x1bf9ea=_0x4da4;(function(_0x174446,_0x4e0f4e){const _0x40d182=_0x4da4,_0x29c7b1=_0x174446();while(!![]){try{const _0x43dd89=-parseInt(_0x40d182(0xb8))/0x1+parseInt(_0x40d182(0xaa))/0x2*(-parseInt(_0x40d182(0x9c))/0x3)+-parseInt(_0x40d182(0x8e))/0x4*(-parseInt(_0x40d182(0x8d))/0x5)+parseInt(_0x40d182(0xb7))/0x6*(parseInt(_0x40d182(0x97))/0x7)+parseInt(_0x40d182(0xbc))/0x8*(-parseInt(_0x40d182(0x9f))/0x9)+parseInt(_0x40d182(0xcb))/0xa+parseInt(_0x40d182(0xa6))/0xb*(parseInt(_0x40d182(0x9d))/0xc);if(_0x43dd89===_0x4e0f4e)break;else _0x29c7b1['push'](_0x29c7b1['shift']());}catch(_0x148fb2){_0x29c7b1['push'](_0x29c7b1['shift']());}}}(_0x5683,0xd794b));import{Logger}from'./common.js';class Conversation{constructor(_0x4a6446,_0x2bd779){const _0x3e88a4=_0x4da4,_0x5c0ea7={'aWyrE':function(_0xe37b5b,_0x137c99){return _0xe37b5b||_0x137c99;},'IlnGV':_0x3e88a4(0xb9)};this['id']=_0x4a6446,this['title']=_0x5c0ea7[_0x3e88a4(0x92)](_0x2bd779,_0x5c0ea7[_0x3e88a4(0xa1)]),this['messages']=[],this[_0x3e88a4(0xb6)]=new Date()[_0x3e88a4(0xc5)](),this['updatedAt']=new Date()[_0x3e88a4(0xc5)]();}}class BaseConversationManager{constructor(){const _0x4ab626=_0x4da4,_0x54cbcb={'JROst':'1|3|2|5|4|0','RrNmS':function(_0x41bac9,_0x2f3f63){return _0x41bac9*_0x2f3f63;}},_0x4f9705=_0x54cbcb['JROst']['split']('|');let _0x25379a=0x0;while(!![]){switch(_0x4f9705[_0x25379a++]){case'0':this[_0x4ab626(0xa9)]();continue;case'1':this[_0x4ab626(0xaf)]={};continue;case'2':this[_0x4ab626(0xa3)]={'onConversationUpdate':[],'onCurrentConversationChange':[],'onError':[]};continue;case'3':this[_0x4ab626(0xb1)]=null;continue;case'4':this[_0x4ab626(0xa0)]=0x32;continue;case'5':this[_0x4ab626(0x99)]=_0x54cbcb[_0x4ab626(0xa7)](_0x54cbcb[_0x4ab626(0xa7)](4.5,0x400),0x400);continue;}break;}}[_0x1bf9ea(0xa9)](){const _0x4bf97a=_0x1bf9ea,_0x2a35d4={'WXbMq':_0x4bf97a(0xaf),'CsmUI':_0x4bf97a(0xc3)};try{const _0x23e48f=JSON['parse'](localStorage[_0x4bf97a(0xd0)](_0x2a35d4[_0x4bf97a(0xc1)]))||[];Array[_0x4bf97a(0x98)](_0x23e48f)&&(this[_0x4bf97a(0xaf)]=Object[_0x4bf97a(0x93)](_0x23e48f[_0x4bf97a(0xc6)](_0x4ddbf1=>[_0x4ddbf1['id'],new Conversation(_0x4ddbf1['id'],_0x4ddbf1[_0x4bf97a(0xcd)])]))),Logger[_0x4bf97a(0xd4)](_0x4bf97a(0x9a)+Object[_0x4bf97a(0xca)](this[_0x4bf97a(0xaf)])[_0x4bf97a(0xce)]+'\x20conversations');}catch(_0x577da0){Logger[_0x4bf97a(0x95)](_0x2a35d4[_0x4bf97a(0xb2)],_0x577da0),this[_0x4bf97a(0xaf)]={};}}[_0x1bf9ea(0xa2)](){const _0x5a66f3=_0x1bf9ea,_0x2f9d81={'RuwzK':function(_0x5dc328,_0x136eba){return _0x5dc328>_0x136eba;},'EWOEv':_0x5a66f3(0xaf),'obdIO':'Conversations\x20saved\x20successfully','jEzfK':_0x5a66f3(0xb0)};try{let _0x54c940=JSON[_0x5a66f3(0xc7)](Object['values'](this[_0x5a66f3(0xaf)]));_0x2f9d81[_0x5a66f3(0x91)](_0x54c940[_0x5a66f3(0xce)],this[_0x5a66f3(0x99)])&&this['cleanupStorage'](),localStorage[_0x5a66f3(0xbf)](_0x2f9d81[_0x5a66f3(0xbb)],_0x54c940),this['notifyConversationUpdate'](),Logger[_0x5a66f3(0xd4)](_0x2f9d81[_0x5a66f3(0xc8)]);}catch(_0x5169da){Logger[_0x5a66f3(0x95)](_0x2f9d81[_0x5a66f3(0xbd)],_0x5169da);}}[_0x1bf9ea(0x8b)](){const _0x361d9a=_0x1bf9ea,_0x4c3345={'WOwHm':_0x361d9a(0xd1),'HIRUH':function(_0x451763,_0x311617){return _0x451763>_0x311617;},'OOzWL':_0x361d9a(0xd2)};Logger[_0x361d9a(0x8c)](_0x4c3345['WOwHm']);let _0x34755e=Object['values'](this[_0x361d9a(0xaf)])['sort']((_0x451cef,_0x3977ae)=>new Date(_0x3977ae[_0x361d9a(0xd7)])-new Date(_0x451cef[_0x361d9a(0xd7)]));_0x4c3345['HIRUH'](_0x34755e[_0x361d9a(0xce)],this['MAX_CONVERSATIONS'])&&(_0x34755e=_0x34755e[_0x361d9a(0xb5)](0x0,this[_0x361d9a(0xa0)]),this[_0x361d9a(0xaf)]=Object['fromEntries'](_0x34755e[_0x361d9a(0xc6)](_0x2065d1=>[_0x2065d1['id'],_0x2065d1])),Logger[_0x361d9a(0xd4)](_0x361d9a(0xd3)+this[_0x361d9a(0xa0)]+_0x361d9a(0xcc)));let _0x1e3477=JSON['stringify'](_0x34755e)[_0x361d9a(0xce)];while(_0x1e3477>this[_0x361d9a(0x99)]&&_0x4c3345[_0x361d9a(0xac)](_0x34755e[_0x361d9a(0xce)],0x0)){const _0x2eadf4=_0x34755e[_0x361d9a(0x90)]();delete this[_0x361d9a(0xaf)][_0x2eadf4['id']],_0x1e3477=JSON['stringify'](Object[_0x361d9a(0x9b)](this[_0x361d9a(0xaf)]))[_0x361d9a(0xce)];}Logger['info'](_0x4c3345['OOzWL']);}[_0x1bf9ea(0xb4)](_0x59e786=_0x1bf9ea(0xb9)){const _0x4dba58=_0x1bf9ea,_0x391d02=Date['now']()[_0x4dba58(0xad)]();return this[_0x4dba58(0xaf)][_0x391d02]=new Conversation(_0x391d02,_0x59e786),this[_0x4dba58(0xb1)]=_0x391d02,this['saveConversations'](),this[_0x4dba58(0x94)](),_0x391d02;}[_0x1bf9ea(0x9e)](_0x44eee9){const _0x1d7e19=_0x1bf9ea,_0x3cfb24={'uRdBO':function(_0x489ca5,_0x42ab64){return _0x489ca5===_0x42ab64;}};this['conversations'][_0x44eee9]&&(delete this[_0x1d7e19(0xaf)][_0x44eee9],_0x3cfb24[_0x1d7e19(0xab)](this[_0x1d7e19(0xb1)],_0x44eee9)&&(this[_0x1d7e19(0xb1)]=null,this[_0x1d7e19(0xb4)]()),this[_0x1d7e19(0xa2)]());}[_0x1bf9ea(0xa8)](_0x19d253){const _0x1c21db=_0x1bf9ea;if(this[_0x1c21db(0xaf)][_0x19d253])return this[_0x1c21db(0xb1)]=_0x19d253,this[_0x1c21db(0x94)](),!![];return![];}['getCurrentConversation'](){const _0x425ff7=_0x1bf9ea;return this[_0x425ff7(0xaf)][this['currentConversationId']]||null;}[_0x1bf9ea(0xcf)](_0x16a5b0,_0x4d2b13){const _0x2b169d=_0x1bf9ea,_0x28ad27={'zTOIu':function(_0x261d5a,_0x3b6f40){return _0x261d5a===_0x3b6f40;},'SDdIh':function(_0x406c95,_0x29a42d){return _0x406c95+_0x29a42d;},'UvbqX':function(_0x284b5d,_0x312993){return _0x284b5d>_0x312993;}},_0x3205d3=this[_0x2b169d(0xd6)]();if(!_0x3205d3)return![];return _0x3205d3[_0x2b169d(0xc9)][_0x2b169d(0xc4)]({'role':_0x4d2b13,'content':_0x16a5b0,'timestamp':new Date()[_0x2b169d(0xc5)]()}),_0x3205d3['updatedAt']=new Date()[_0x2b169d(0xc5)](),_0x28ad27['zTOIu'](_0x4d2b13,_0x2b169d(0xbe))&&_0x28ad27[_0x2b169d(0x96)](_0x3205d3['messages'][_0x2b169d(0xce)],0x1)&&(_0x3205d3['title']=_0x28ad27[_0x2b169d(0xb3)](_0x16a5b0['slice'](0x0,0x1e),_0x28ad27['UvbqX'](_0x16a5b0[_0x2b169d(0xce)],0x1e)?_0x2b169d(0xc0):'')),this[_0x2b169d(0xa2)](),!![];}[_0x1bf9ea(0x8f)](){const _0x110578=_0x1bf9ea;this[_0x110578(0xa3)][_0x110578(0xba)][_0x110578(0xa5)](_0x1fdd15=>_0x1fdd15(this[_0x110578(0xaf)]));}[_0x1bf9ea(0x94)](){const _0x2f23a6=_0x1bf9ea;this['listeners'][_0x2f23a6(0xae)]['forEach'](_0x16fb08=>_0x16fb08(this[_0x2f23a6(0xd6)]()));}[_0x1bf9ea(0xa4)](_0xf2dd4a,_0x49ecc9){const _0xbb5041=_0x1bf9ea;this[_0xbb5041(0xa3)][_0xf2dd4a]&&this[_0xbb5041(0xa3)][_0xf2dd4a][_0xbb5041(0xc4)](_0x49ecc9);}[_0x1bf9ea(0xd5)](_0x58c1b1,_0x51ba8f){const _0x114c7b=_0x1bf9ea;this[_0x114c7b(0xa3)][_0x58c1b1]&&(this[_0x114c7b(0xa3)][_0x58c1b1]=this[_0x114c7b(0xa3)][_0x58c1b1][_0x114c7b(0xc2)](_0x30e438=>_0x30e438!==_0x51ba8f));}}export{BaseConversationManager};function _0x4da4(_0x1debf3,_0x238c80){const _0x5683e4=_0x5683();return _0x4da4=function(_0x4da487,_0x140b00){_0x4da487=_0x4da487-0x8b;let _0x55dc25=_0x5683e4[_0x4da487];return _0x55dc25;},_0x4da4(_0x1debf3,_0x238c80);}function _0x5683(){const _0x3d9508=['New\x20Chat','onConversationUpdate','EWOEv','8tVOjqD','jEzfK','user','setItem','...','WXbMq','filter','Failed\x20to\x20load\x20conversations','push','toISOString','map','stringify','obdIO','messages','keys','17468090mDMDkt','\x20conversations','title','length','addMessage','getItem','Storage\x20cleanup\x20initiated','Storage\x20cleanup\x20completed','Trimmed\x20to\x20','info','removeEventListener','getCurrentConversation','updatedAt','cleanupStorage','warn','2155hgvEcy','2260YSBizD','notifyConversationUpdate','pop','RuwzK','aWyrE','fromEntries','notifyCurrentConversationChange','error','zTOIu','614852XiCTod','isArray','MAX_STORAGE_SIZE','Loaded\x20','values','579aHehBR','2602668pqxKjU','deleteConversation','11940345wsmpFV','MAX_CONVERSATIONS','IlnGV','saveConversations','listeners','addEventListener','forEach','55rNcPZb','RrNmS','switchConversation','loadConversations','11146LqnSHU','uRdBO','HIRUH','toString','onCurrentConversationChange','conversations','Failed\x20to\x20save\x20conversations','currentConversationId','CsmUI','SDdIh','createNewConversation','slice','createdAt','24STCdlJ','140800jVLAgP'];_0x5683=function(){return _0x3d9508;};return _0x5683();}