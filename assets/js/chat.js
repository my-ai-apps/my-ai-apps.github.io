
/*!
Copyright Â© 2024 Saisha Pandit. All Rights Reserved.
Unauthorized use, modification, or distribution is strictly prohibited.
*/
const _0x15f41b=_0x28ec;(function(_0x19eb89,_0x27a14e){const _0x189854=_0x28ec,_0x586f3b=_0x19eb89();while(!![]){try{const _0x58be2e=-parseInt(_0x189854(0x14c))/0x1+-parseInt(_0x189854(0x11a))/0x2+-parseInt(_0x189854(0x117))/0x3*(parseInt(_0x189854(0x106))/0x4)+-parseInt(_0x189854(0x12a))/0x5*(parseInt(_0x189854(0x13e))/0x6)+parseInt(_0x189854(0x149))/0x7+-parseInt(_0x189854(0x102))/0x8+-parseInt(_0x189854(0x135))/0x9*(-parseInt(_0x189854(0x13c))/0xa);if(_0x58be2e===_0x27a14e)break;else _0x586f3b['push'](_0x586f3b['shift']());}catch(_0x9a2deb){_0x586f3b['push'](_0x586f3b['shift']());}}}(_0x40d2,0xd3201));import{BaseConversationManager}from'./BaseConversationManager.js';import{Logger}from'./common.js';import{aiLanguageSession,initializeLanguageSession,sessionConfig}from'./aiCommon.js';const welcomeScreen=document[_0x15f41b(0x130)](_0x15f41b(0x10e)),chatContainer=document[_0x15f41b(0x130)](_0x15f41b(0x13a)),messagesContainer=document[_0x15f41b(0x130)](_0x15f41b(0x12e)),messageInput=document[_0x15f41b(0x130)]('messageInput'),sendButton=document[_0x15f41b(0x130)](_0x15f41b(0x128)),micButton=document[_0x15f41b(0x130)](_0x15f41b(0x119)),errorMessage=document[_0x15f41b(0x130)](_0x15f41b(0x10c)),loader=document[_0x15f41b(0x130)](_0x15f41b(0x121)),example1=document[_0x15f41b(0x130)](_0x15f41b(0x108)),example2=document[_0x15f41b(0x130)](_0x15f41b(0x114)),newChatButton=document[_0x15f41b(0x130)](_0x15f41b(0xfd)),settingsButton=document[_0x15f41b(0x130)](_0x15f41b(0x10b)),inputContainer=document[_0x15f41b(0x14d)](_0x15f41b(0x131)),conversationManager=new BaseConversationManager();function toggleChatUI(){const _0x43f88f=_0x15f41b,_0x16b26c={'KvbYb':_0x43f88f(0x105)};if(welcomeScreen)welcomeScreen[_0x43f88f(0x10f)][_0x43f88f(0x10a)]=_0x43f88f(0x136);if(chatContainer)chatContainer[_0x43f88f(0x10f)][_0x43f88f(0x10a)]=_0x16b26c[_0x43f88f(0x11c)];if(inputContainer)inputContainer['style'][_0x43f88f(0x10a)]=_0x16b26c[_0x43f88f(0x11c)];if(messageInput)messageInput[_0x43f88f(0x148)]();}function updateMessagesUI(_0x2b37a8){const _0x38bc80=_0x15f41b,_0xbca99b={'NJhmc':'div','gWsCU':'message','dGteC':'user','Cxqrr':_0x38bc80(0xff),'Htyev':'message-ai'};if(!messagesContainer)return;messagesContainer['innerHTML']='',_0x2b37a8[_0x38bc80(0xfa)](_0x146e93=>{const _0x127efa=_0x38bc80,_0x159540=document['createElement'](_0xbca99b['NJhmc']);_0x159540['classList']['add'](_0xbca99b[_0x127efa(0x146)],_0x146e93['role']===_0xbca99b[_0x127efa(0x144)]?_0xbca99b[_0x127efa(0x129)]:_0xbca99b[_0x127efa(0x100)]),_0x159540[_0x127efa(0x141)]=_0x146e93[_0x127efa(0x14f)]===_0xbca99b[_0x127efa(0x144)]?_0x127efa(0x153)+_0x146e93[_0x127efa(0x14a)]+_0x127efa(0x101):_0x127efa(0xf9)+_0x146e93[_0x127efa(0x14a)]+_0x127efa(0x101),messagesContainer[_0x127efa(0x147)](_0x159540);}),messagesContainer[_0x38bc80(0x110)]=messagesContainer['scrollHeight'];}async function sendMessage(){const _0x18476a=_0x15f41b,_0x2449e3={'kxVYP':function(_0x5498ab){return _0x5498ab();},'gOnni':'user','qcyZB':_0x18476a(0x140),'glISU':'system','rdrDf':_0x18476a(0x132),'Cgnyb':_0x18476a(0x142),'ZlTcn':_0x18476a(0x12c),'NYYhd':_0x18476a(0x109),'ULzWP':function(_0x4dd950,_0x59ceb7){return _0x4dd950(_0x59ceb7);}},_0x3c6ad6=messageInput[_0x18476a(0x11f)][_0x18476a(0x11d)]();if(!_0x3c6ad6)return;_0x2449e3[_0x18476a(0x150)](toggleChatUI),await conversationManager['addMessage'](_0x3c6ad6,_0x2449e3[_0x18476a(0x124)]);const _0x5cd20c=await conversationManager[_0x18476a(0x154)]();updateMessagesUI(_0x5cd20c[_0x18476a(0x137)]),messageInput[_0x18476a(0x11f)]='',messageInput['style'][_0x18476a(0x104)]=_0x2449e3['qcyZB'];try{if(!aiLanguageSession)await _0x2449e3['kxVYP'](initializeLanguageSession);const _0x487bef=[{'role':_0x2449e3[_0x18476a(0x112)],'content':sessionConfig['systemRole']},..._0x5cd20c[_0x18476a(0x137)]],_0x2ad4e6=await aiLanguageSession[_0x18476a(0x118)](JSON[_0x18476a(0x134)](_0x487bef));let _0x1ea47b='';const _0x3b7760=document[_0x18476a(0x13d)](_0x2449e3[_0x18476a(0x138)]);_0x3b7760['classList']['add'](_0x2449e3[_0x18476a(0x107)],_0x18476a(0x155)),_0x3b7760[_0x18476a(0x141)]=_0x18476a(0x145),messagesContainer[_0x18476a(0x147)](_0x3b7760);const _0x1baea8=_0x3b7760['querySelector'](_0x2449e3[_0x18476a(0x122)]);for await(const _0x26635c of _0x2ad4e6){_0x1ea47b+=_0x26635c,_0x1baea8[_0x18476a(0x116)]=_0x1ea47b,messagesContainer[_0x18476a(0x110)]=messagesContainer[_0x18476a(0x126)];}await conversationManager[_0x18476a(0x14e)](_0x1ea47b,_0x18476a(0x13f));}catch(_0x184d19){Logger['error'](_0x18476a(0x11e),_0x184d19);const _0x28c442=_0x2449e3[_0x18476a(0x133)];await conversationManager[_0x18476a(0x14e)](_0x28c442,_0x18476a(0x13f)),_0x2449e3[_0x18476a(0x11b)](updateMessagesUI,conversationManager['getCurrentConversation']()['messages']);}}document[_0x15f41b(0x152)](_0x15f41b(0x113),async()=>{const _0x3b2599=_0x15f41b,_0x34d045={'wuEso':function(_0x65f842){return _0x65f842();},'JSJgt':_0x3b2599(0x143)};try{if(!aiLanguageSession)await _0x34d045[_0x3b2599(0xfc)](initializeLanguageSession);!conversationManager['getCurrentConversation']()&&conversationManager['createNewConversation']();}catch(_0xd6c7e8){Logger[_0x3b2599(0x12b)](_0x34d045[_0x3b2599(0x12d)],_0xd6c7e8);}});if(sendButton)sendButton[_0x15f41b(0x152)](_0x15f41b(0x103),sendMessage);messageInput&&(messageInput[_0x15f41b(0x152)](_0x15f41b(0x125),_0x44c9fd=>{const _0x432ac4=_0x15f41b,_0x66d86c={'KIpSI':function(_0x12a959,_0x6f1c0b){return _0x12a959===_0x6f1c0b;},'HcRXq':_0x432ac4(0x111),'IblZB':function(_0x5368e9){return _0x5368e9();}};_0x66d86c[_0x432ac4(0xfe)](_0x44c9fd['key'],_0x66d86c[_0x432ac4(0x14b)])&&!_0x44c9fd[_0x432ac4(0x12f)]&&(_0x44c9fd[_0x432ac4(0x10d)](),_0x66d86c['IblZB'](sendMessage));}),messageInput[_0x15f41b(0x152)](_0x15f41b(0x148),toggleChatUI));newChatButton&&newChatButton['addEventListener'](_0x15f41b(0x103),()=>{const _0x1bfa38=_0x15f41b,_0x50be80={'KOrQx':_0x1bfa38(0x123),'ECkBY':_0x1bfa38(0x105),'WLAWK':_0x1bfa38(0x136)},_0x1da594=_0x50be80[_0x1bfa38(0x139)][_0x1bfa38(0xfb)]('|');let _0x261e59=0x0;while(!![]){switch(_0x1da594[_0x261e59++]){case'0':if(messagesContainer)messagesContainer[_0x1bfa38(0x141)]='';continue;case'1':if(welcomeScreen)welcomeScreen['style'][_0x1bfa38(0x10a)]=_0x50be80[_0x1bfa38(0x13b)];continue;case'2':if(chatContainer)chatContainer[_0x1bfa38(0x10f)][_0x1bfa38(0x10a)]=_0x50be80[_0x1bfa38(0x120)];continue;case'3':conversationManager[_0x1bfa38(0x115)]();continue;case'4':if(messageInput)messageInput[_0x1bfa38(0x11f)]='';continue;}break;}});function _0x28ec(_0x584ab8,_0x24fbe8){const _0x40d264=_0x40d2();return _0x28ec=function(_0x28ec39,_0x1aef87){_0x28ec39=_0x28ec39-0xf9;let _0x80eddf=_0x40d264[_0x28ec39];return _0x80eddf;},_0x28ec(_0x584ab8,_0x24fbe8);}function _0x40d2(){const _0x257134=['style','scrollTop','Enter','glISU','DOMContentLoaded','example2','createNewConversation','textContent','615qWFTNK','promptStreaming','micButton','1133334wRCxiy','ULzWP','KvbYb','trim','Response\x20error:','value','WLAWK','loader','ZlTcn','3|0|1|2|4','gOnni','keydown','scrollHeight','SYZDD','sendButton','Cxqrr','25VPJiKR','error','.message-content','JSJgt','messagesContainer','shiftKey','getElementById','.input-container','div','NYYhd','stringify','9fkCnEw','none','messages','rdrDf','KOrQx','chatContainer','ECkBY','42051770OQxzsX','createElement','1785948ndlCrX','assistant','auto','innerHTML','message','Initialization\x20failed','dGteC','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22message-ai-avatar\x22><i\x20class=\x22fas\x20fa-robot\x22></i></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22message-content\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','gWsCU','appendChild','focus','12058648sPpkRb','content','HcRXq','758842CZcYUK','querySelector','addMessage','role','kxVYP','settings.html','addEventListener','<div\x20class=\x22message-content\x22>','getCurrentConversation','message-ai','<div\x20class=\x22message-ai-avatar\x22><i\x20class=\x22fas\x20fa-robot\x22></i></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22message-content\x22>','forEach','split','wuEso','newChatButton','KIpSI','message-user','Htyev','</div>','4839744KXFMKo','click','height','flex','32084YXVZEh','Cgnyb','example1','I\x27m\x20sorry,\x20I\x20couldn\x27t\x20generate\x20a\x20response.\x20Please\x20try\x20again.','display','settingsButton','errorMessage','preventDefault','welcomeScreen'];_0x40d2=function(){return _0x257134;};return _0x40d2();}settingsButton&&settingsButton[_0x15f41b(0x152)]('click',()=>{const _0x4eccb1=_0x15f41b,_0x6db15={'SYZDD':_0x4eccb1(0x151)};window['location']['href']=_0x6db15[_0x4eccb1(0x127)];});export{conversationManager,sendMessage};