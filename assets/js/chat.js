
/*!
Copyright Â© 2024 Saisha Pandit. All Rights Reserved.
Unauthorized use, modification, or distribution is strictly prohibited.
*/
const _0x59b84d=_0x46f1;(function(_0x438117,_0xc3f3d3){const _0x290d72=_0x46f1,_0x20ddf5=_0x438117();while(!![]){try{const _0x50112e=-parseInt(_0x290d72(0xa7))/0x1+-parseInt(_0x290d72(0xd0))/0x2*(parseInt(_0x290d72(0xbf))/0x3)+-parseInt(_0x290d72(0xb2))/0x4+parseInt(_0x290d72(0x96))/0x5*(parseInt(_0x290d72(0xd9))/0x6)+parseInt(_0x290d72(0xad))/0x7+-parseInt(_0x290d72(0xd5))/0x8*(parseInt(_0x290d72(0x9d))/0x9)+parseInt(_0x290d72(0xdc))/0xa;if(_0x50112e===_0xc3f3d3)break;else _0x20ddf5['push'](_0x20ddf5['shift']());}catch(_0x1aaa96){_0x20ddf5['push'](_0x20ddf5['shift']());}}}(_0x2140,0x41f7d));import{BaseConversationManager}from'./BaseConversationManager.js';import{Logger}from'./common.js';import{aiLanguageSession,initializeLanguageSession,sessionConfig}from'./aiCommon.js';const welcomeScreen=document['getElementById'](_0x59b84d(0xa0)),chatContainer=document[_0x59b84d(0xa6)](_0x59b84d(0x9c)),messagesContainer=document['getElementById']('messagesContainer'),messageInput=document[_0x59b84d(0xa6)](_0x59b84d(0x87)),sendButton=document[_0x59b84d(0xa6)](_0x59b84d(0xa8)),micButton=document[_0x59b84d(0xa6)](_0x59b84d(0xd2)),errorMessage=document['getElementById'](_0x59b84d(0x9a)),loader=document[_0x59b84d(0xa6)](_0x59b84d(0xac)),example1=document[_0x59b84d(0xa6)]('example1'),example2=document[_0x59b84d(0xa6)]('example2'),newChatButton=document['getElementById'](_0x59b84d(0xc5)),settingsButton=document[_0x59b84d(0xa6)](_0x59b84d(0x9e)),inputContainer=document[_0x59b84d(0x90)](_0x59b84d(0xbb)),conversationManager=new BaseConversationManager();function toggleChatUI(){const _0x7c18aa=_0x59b84d,_0x4f0c01={'XbYCF':_0x7c18aa(0xd1)};if(welcomeScreen)welcomeScreen[_0x7c18aa(0x85)]['display']=_0x7c18aa(0xc8);if(chatContainer)chatContainer[_0x7c18aa(0x85)][_0x7c18aa(0xd3)]=_0x4f0c01[_0x7c18aa(0xba)];if(inputContainer)inputContainer[_0x7c18aa(0x85)][_0x7c18aa(0xd3)]=_0x4f0c01['XbYCF'];if(messageInput)messageInput[_0x7c18aa(0xc6)]();}function updateMessagesUI(_0x20f703){const _0x596a44=_0x59b84d,_0x417caf={'jiPmc':_0x596a44(0xd8),'xbPME':_0x596a44(0x86),'yKCsj':function(_0x20be5a,_0x482f65){return _0x20be5a===_0x482f65;},'bhbfn':_0x596a44(0x94),'PEgEN':'message-user','Gtcrm':'message-ai','uPZQx':function(_0x485b9b,_0x557c56){return _0x485b9b===_0x557c56;}};if(!messagesContainer)return;messagesContainer[_0x596a44(0xd6)]='',_0x20f703[_0x596a44(0x92)](_0xdc20aa=>{const _0x2a20cc=_0x596a44,_0x496114=document[_0x2a20cc(0xc9)](_0x417caf['jiPmc']);_0x496114[_0x2a20cc(0x89)]['add'](_0x417caf[_0x2a20cc(0x9b)],_0x417caf[_0x2a20cc(0x91)](_0xdc20aa[_0x2a20cc(0xa1)],_0x417caf['bhbfn'])?_0x417caf[_0x2a20cc(0xcd)]:_0x417caf['Gtcrm']),_0x496114[_0x2a20cc(0xd6)]=_0x417caf[_0x2a20cc(0xb0)](_0xdc20aa[_0x2a20cc(0xa1)],_0x417caf[_0x2a20cc(0xa3)])?_0x2a20cc(0xa4)+_0xdc20aa['content']+_0x2a20cc(0xab):_0x2a20cc(0x8e)+_0xdc20aa[_0x2a20cc(0xc0)]+_0x2a20cc(0xab),messagesContainer[_0x2a20cc(0xd7)](_0x496114);}),messagesContainer['scrollTop']=messagesContainer['scrollHeight'];}async function sendMessage(){const _0x5360ab=_0x59b84d,_0x51488d={'hJeai':function(_0x30fe52){return _0x30fe52();},'sIoJc':_0x5360ab(0x94),'SyKfN':function(_0x1b2d85,_0x216a98){return _0x1b2d85(_0x216a98);},'FJKck':_0x5360ab(0xb8),'cSfUd':_0x5360ab(0xd4),'XfUvA':'div','dUKqK':_0x5360ab(0x86),'lxPbR':_0x5360ab(0xb5),'jAOBd':_0x5360ab(0x8c),'bJilb':'Response\x20error:','kUeiM':_0x5360ab(0xa2)},_0x4da91b=messageInput[_0x5360ab(0x95)][_0x5360ab(0xbe)]();if(!_0x4da91b)return;_0x51488d['hJeai'](toggleChatUI),await conversationManager[_0x5360ab(0xb9)](_0x4da91b,_0x51488d[_0x5360ab(0x98)]);const _0x8a8e91=await conversationManager['getCurrentConversation']();_0x51488d[_0x5360ab(0x93)](updateMessagesUI,_0x8a8e91[_0x5360ab(0xc1)]),messageInput[_0x5360ab(0x95)]='',messageInput['style']['height']=_0x51488d[_0x5360ab(0xdb)];try{if(!aiLanguageSession)await initializeLanguageSession();const _0x54f1d5=[{'role':_0x51488d['cSfUd'],'content':sessionConfig[_0x5360ab(0xce)]},..._0x8a8e91[_0x5360ab(0xc1)]],_0x4a55e3=await aiLanguageSession[_0x5360ab(0x88)](JSON[_0x5360ab(0xaa)](_0x54f1d5));let _0x26ede7='';const _0x5a8710=document['createElement'](_0x51488d[_0x5360ab(0x97)]);_0x5a8710['classList'][_0x5360ab(0xc3)](_0x51488d[_0x5360ab(0xbd)],_0x5360ab(0xc7)),_0x5a8710[_0x5360ab(0xd6)]=_0x5360ab(0xa9),messagesContainer[_0x5360ab(0xd7)](_0x5a8710);const _0x1740a1=_0x5a8710[_0x5360ab(0x90)](_0x51488d['lxPbR']);for await(const _0x9913df of _0x4a55e3){_0x26ede7+=_0x9913df,_0x1740a1[_0x5360ab(0xbc)]=_0x26ede7,messagesContainer[_0x5360ab(0xcc)]=messagesContainer['scrollHeight'];}await conversationManager['addMessage'](_0x26ede7,_0x51488d[_0x5360ab(0xb4)]);}catch(_0x412ad1){Logger[_0x5360ab(0xca)](_0x51488d[_0x5360ab(0xc4)],_0x412ad1);const _0x311afa=_0x51488d[_0x5360ab(0xae)];await conversationManager[_0x5360ab(0xb9)](_0x311afa,_0x5360ab(0x8c)),updateMessagesUI(conversationManager['getCurrentConversation']()[_0x5360ab(0xc1)]);}}function _0x2140(){const _0x4ad9b9=['I\x27m\x20sorry,\x20I\x20couldn\x27t\x20generate\x20a\x20response.\x20Please\x20try\x20again.','bhbfn','<div\x20class=\x22message-content\x22>','psZbW','getElementById','266376JXxXkR','sendButton','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22message-ai-avatar\x22><i\x20class=\x22fas\x20fa-robot\x22></i></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22message-content\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','stringify','</div>','loader','3725071TRuyAk','kUeiM','preventDefault','uPZQx','key','1220132ImjGti','click','jAOBd','.message-content','shiftKey','Mqjtl','auto','addMessage','XbYCF','.input-container','textContent','dUKqK','trim','3SjVMxU','content','messages','CDYJf','add','bJilb','newChatButton','focus','message-ai','none','createElement','error','WRojI','scrollTop','PEgEN','systemRole','href','841198FOjoGF','flex','micButton','display','system','492224nvolcn','innerHTML','appendChild','div','2287518cHwDkS','settings.html','FJKck','4103350LeCWpj','Initialization\x20failed','style','message','messageInput','promptStreaming','classList','createNewConversation','location','assistant','ojkkC','<div\x20class=\x22message-ai-avatar\x22><i\x20class=\x22fas\x20fa-robot\x22></i></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22message-content\x22>','Enter','querySelector','yKCsj','forEach','SyKfN','user','value','5begtHp','XfUvA','sIoJc','keydown','errorMessage','xbPME','chatContainer','9VNhXgg','settingsButton','addEventListener','welcomeScreen','role'];_0x2140=function(){return _0x4ad9b9;};return _0x2140();}document[_0x59b84d(0x9f)]('DOMContentLoaded',async()=>{const _0x5e7876=_0x59b84d,_0x8ee8a4={'CDYJf':_0x5e7876(0xdd)};try{if(!aiLanguageSession)await initializeLanguageSession();!conversationManager['getCurrentConversation']()&&conversationManager['createNewConversation']();}catch(_0x59e625){Logger[_0x5e7876(0xca)](_0x8ee8a4[_0x5e7876(0xc2)],_0x59e625);}});if(sendButton)sendButton[_0x59b84d(0x9f)](_0x59b84d(0xb3),sendMessage);messageInput&&(messageInput[_0x59b84d(0x9f)](_0x59b84d(0x99),_0x2a59f3=>{const _0x39e259=_0x59b84d,_0x160a53={'Mqjtl':_0x39e259(0x8f),'WRojI':function(_0x2a7446){return _0x2a7446();}};_0x2a59f3[_0x39e259(0xb1)]===_0x160a53[_0x39e259(0xb7)]&&!_0x2a59f3[_0x39e259(0xb6)]&&(_0x2a59f3[_0x39e259(0xaf)](),_0x160a53[_0x39e259(0xcb)](sendMessage));}),messageInput[_0x59b84d(0x9f)](_0x59b84d(0xc6),toggleChatUI));newChatButton&&newChatButton[_0x59b84d(0x9f)](_0x59b84d(0xb3),()=>{const _0x4ae586=_0x59b84d,_0x2f1fd5={'psZbW':_0x4ae586(0xd1),'BYDbQ':_0x4ae586(0xc8)};conversationManager[_0x4ae586(0x8a)]();if(messagesContainer)messagesContainer['innerHTML']='';if(welcomeScreen)welcomeScreen[_0x4ae586(0x85)][_0x4ae586(0xd3)]=_0x2f1fd5[_0x4ae586(0xa5)];if(chatContainer)chatContainer['style'][_0x4ae586(0xd3)]=_0x2f1fd5['BYDbQ'];if(messageInput)messageInput[_0x4ae586(0x95)]='';});settingsButton&&settingsButton[_0x59b84d(0x9f)](_0x59b84d(0xb3),()=>{const _0x34b395=_0x59b84d,_0x4b8754={'ojkkC':_0x34b395(0xda)};window[_0x34b395(0x8b)][_0x34b395(0xcf)]=_0x4b8754[_0x34b395(0x8d)];});function _0x46f1(_0x5dda92,_0x1f3526){const _0x2140f8=_0x2140();return _0x46f1=function(_0x46f14d,_0x4bc8c7){_0x46f14d=_0x46f14d-0x85;let _0xf9adb9=_0x2140f8[_0x46f14d];return _0xf9adb9;},_0x46f1(_0x5dda92,_0x1f3526);}export{conversationManager,sendMessage};