
/*!
Copyright Â© 2024 Saisha Pandit. All Rights Reserved.
Unauthorized use, modification, or distribution is strictly prohibited.
*/
function _0x5696(_0x118456,_0x4d8ced){const _0x1e4822=_0x1e48();return _0x5696=function(_0x569669,_0x9ab699){_0x569669=_0x569669-0x1d0;let _0x3d8062=_0x1e4822[_0x569669];return _0x3d8062;},_0x5696(_0x118456,_0x4d8ced);}function _0x1e48(){const _0x4193ee=['YtZae','Using\x20browser\x20AI:\x20useBrowserAI=','Error\x20generating\x20AI\x20response\x20using\x20browser\x20model.','8102990cjxaJU','progressPercent','vnvcN','mdCLY','sessionConfig','startTime','split','http://localhost:1234/v1/chat/completions','generateResponse','text-generation','content','FaWgU','âœ…\x20Model\x20Loaded\x20Successfully\x20in\x20','MKdDT','create','requestAdapter','engineWrapper','Bearer\x20','2952456jAqrfj','generateText','read','ðŸ¤–\x20[aiAdapter]\x20Raw\x20AI\x20Response:','Browser\x20AI\x20streaming\x20error:','3585726jXCcSe','info','ptyzU','âœ…\x20Model\x20Loaded\x20Successfully','error','getItem','wgQni','sk-proj-1234567890','zBWjZ','WdKaJ','_checkWebGPUSupport','groupEnd','âœ…\x20WebGPU\x20fully\x20supported','tnvFH','OWyoQ','toFixed','stringify','SngBO','pHvXn','kNtsW','5maRYjl','text','XXTvx','MLC','choices','950261wGYuTB','MUoAX','AI\x20Initialization\x20Failure','[Init]\x20Language\x20model\x20session\x20already\x20exists:','cleanJSONMarkdown','IPUZF','POST','cleanJSONMarkdown:\x20Raw\x20JSON\x20response:\x20','OXeYZ','iBnZP','KfGVp','EkEdi','application/json','log','loadingStats','mlc','languageModel','Phi-3.5-mini-instruct','AIAdapter\x20is\x20not\x20initialized.\x20Please\x20call\x20init()\x20first.','BROWSER_AI','qoCFL','useBrowserAI','tinyllama-1.1b-chat-v0.4','mlc_ai','getInstance','TLezA','hPeYp','oWVlB','YeugA','[Init]\x20Failed\x20to\x20initialize\x20AI\x20model\x20session.','wrSuf','\x20ms','Error\x20Stacktrace','close','Worker','mlc-ai/Phi-3.5-mini-instruct-{quantization}-MLC','634908YFykQa','status','exdxW','init','[Fallback]\x20Using\x20default\x20model:','gpu','kNKAB','isModelCached','[Init]\x20BrowserAI\x20session\x20initialized\x20with\x20Temperature:\x20','temperature','YbLDl','match','decode','isModelLoaded','isInitialized','qUqQx','cPzvs','XvLVV','useWebWorker','ywvfj','modelIdentifier','getReader','ðŸ›‘\x20Response\x20is\x20already\x20an\x20object,\x20skipping\x20JSON.parse.','_instance','NULL','[AIAdapter]\x20Cleanup\x20complete.','JqTgQ','progressText','progress','KtQcA','now','3206376lTXtPH','1|4|0|3|2','customModels','defaultModel','parse','ZSzmR','loadModel','trace','tXQeL','QqrEM','VmCys','[Init]\x20No\x20suitable\x20AI\x20model\x20found.\x20Falling\x20back\x20to\x20OpenAI\x20API.','uldlh','Initialization\x20Error:','uhNxi','koINb','cleanup','statusText','GKtVw','null','âŒ\x20_checkWebGPUSupport:\x20WebGPU\x20not\x20supported\x20in\x20this\x20browser','[Init]\x20Creating\x20AI\x20language\x20model\x20session...','Browser\x20AI\x20session\x20error:','Error\x20generating\x20response\x20using\x20MLC\x20model.\x20Falling\x20back\x20to\x20alternative.','warn','modelConfig','qXzZJ','yMlin','3|0|1|5|4|2','MLC\x20model\x20streaming\x20error:','loadingProgress','open_ai','textContent','OpenAI\x20API\x20call\x20error:','cBaFp','browser_ai','vRoFu','EnsEq','qEcjM','Rqisw','âœ…\x20BrowserAI\x20Model\x20Loaded\x20Successfully','1632186Ikmwnb','MLC\x20model\x20generation\x20error:','AJbzs','\x22\x20not\x20recognized.','OpenAI\x20API\x20error:\x20','message','delta','q4f16_1','body','jwwjm','[MLC]\x20Loading\x20progress:','topK',',\x20TopK:\x20','object','ccPSi',']\x20Progress:','uzAgQ','q4f32_1','MODEL_CONFIG','systemRole','qiniK','âŒ\x20_checkWebGPUSupport:\x20WebGPU\x20Check\x20Error:','aiLanguageSession','uxwbg','mlc-ai/TinyLlama-1.1B-Chat-v0.4-{quantization}-MLC','freeze','[AIAdapter:constructor]\x20Browser\x20AI\x20API\x20available:','includes','[BrowserAI]\x20generateResponseStream\x20','OpenAI\x20streaming\x20error:','VAMBB','mark','modelType','Error:\x20'];_0x1e48=function(){return _0x4193ee;};return _0x1e48();}const _0x2c09ea=_0x5696;(function(_0x95d1c9,_0x52d1c2){const _0xf64d93=_0x5696,_0x2765e0=_0x95d1c9();while(!![]){try{const _0x513791=parseInt(_0xf64d93(0x268))/0x1+parseInt(_0xf64d93(0x28c))/0x2+parseInt(_0xf64d93(0x24f))/0x3+-parseInt(_0xf64d93(0x24a))/0x4+parseInt(_0xf64d93(0x263))/0x5*(-parseInt(_0xf64d93(0x213))/0x6)+-parseInt(_0xf64d93(0x238))/0x7+parseInt(_0xf64d93(0x1ea))/0x8;if(_0x513791===_0x52d1c2)break;else _0x2765e0['push'](_0x2765e0['shift']());}catch(_0x542c48){_0x2765e0['push'](_0x2765e0['shift']());}}}(_0x1e48,0xa9ee7));import{Logger,displayError,showStatus}from'./common.js';import{MLCEngineWrapper}from'./model/mlcEngineWrapper.js';const OpenAIURL=_0x2c09ea(0x23f),apiKey=_0x2c09ea(0x256),defaultModelName=_0x2c09ea(0x27e);export const ModelTypes=Object[_0x2c09ea(0x22c)]({'NULL':_0x2c09ea(0x1fd),'MLC_AI':_0x2c09ea(0x27f),'BROWSER_AI':_0x2c09ea(0x20d),'OPEN_AI':_0x2c09ea(0x209)});export class AIAdapter{static ['_instance']=null;static[_0x2c09ea(0x280)](_0x582f38=defaultModelName){const _0x2491d6=_0x2c09ea;return!AIAdapter[_0x2491d6(0x1e2)]&&(AIAdapter[_0x2491d6(0x1e2)]=new AIAdapter(_0x582f38)),AIAdapter[_0x2491d6(0x1e2)];}constructor(_0x15e05b=defaultModelName){const _0x1d06eb=_0x2c09ea,_0xc59b30={'zbREF':'modelLoadStart','koINb':'TinyLlama-1.1B-Chat-v0.4','ZSzmR':_0x1d06eb(0x22b),'fTsCT':_0x1d06eb(0x21a),'SngBO':_0x1d06eb(0x224),'FaWgU':'text-generation','TLezA':_0x1d06eb(0x277),'pHvXn':_0x1d06eb(0x279),'yMlin':_0x1d06eb(0x28b),'WdKaJ':_0x1d06eb(0x22d)};if(AIAdapter[_0x1d06eb(0x1e2)])return AIAdapter['_instance'];AIAdapter[_0x1d06eb(0x1e2)]=this,this[_0x1d06eb(0x1ec)]={},this[_0x1d06eb(0x1dd)]=!![],this[_0x1d06eb(0x1df)]=_0x15e05b,this[_0x1d06eb(0x208)]=0x0,this[_0x1d06eb(0x1e6)]='',this[_0x1d06eb(0x239)]=0x0,this[_0x1d06eb(0x226)]='You\x20are\x20a\x20helpful\x20assistant5.',this[_0x1d06eb(0x233)]=ModelTypes[_0x1d06eb(0x1e3)],performance[_0x1d06eb(0x232)](_0xc59b30['zbREF']),this[_0x1d06eb(0x23d)]=performance['now'](),this[_0x1d06eb(0x276)]={'startTime':this[_0x1d06eb(0x23d)],'progress':0x0,'estimatedTimeRemaining':null},this[_0x1d06eb(0x225)]={'tinyllama-1.1b-chat-v0.4':{'engine':'mlc','modelName':_0xc59b30[_0x1d06eb(0x1f9)],'modelType':_0x1d06eb(0x241),'repo':_0xc59b30[_0x1d06eb(0x1ef)],'quantizations':[_0xc59b30['fTsCT'],_0xc59b30[_0x1d06eb(0x260)]],'defaultQuantization':_0x1d06eb(0x224),'pipeline':_0xc59b30[_0x1d06eb(0x243)]},'phi-3.5-mini-instruct':{'engine':_0xc59b30[_0x1d06eb(0x281)],'modelName':_0xc59b30[_0x1d06eb(0x261)],'modelType':_0xc59b30[_0x1d06eb(0x243)],'repo':_0xc59b30[_0x1d06eb(0x205)],'quantizations':['q4f16_1',_0xc59b30[_0x1d06eb(0x260)]],'defaultQuantization':_0xc59b30[_0x1d06eb(0x260)],'pipeline':_0xc59b30['FaWgU']}},this['modelConfig']=this[_0x1d06eb(0x1ec)][this[_0x1d06eb(0x1df)]]||this[_0x1d06eb(0x225)][this['modelIdentifier']];if(!this['modelConfig'])throw new Error('Model\x20identifier\x20\x22'+this[_0x1d06eb(0x1df)]+_0x1d06eb(0x216));this[_0x1d06eb(0x1d9)]=![],this['engineWrapper']=new MLCEngineWrapper(this[_0x1d06eb(0x203)],this[_0x1d06eb(0x1dd)]),this[_0x1d06eb(0x27d)]=!!(self['ai']&&self['ai'][_0x1d06eb(0x278)]),console[_0x1d06eb(0x275)](_0xc59b30[_0x1d06eb(0x258)],this[_0x1d06eb(0x27d)]),this['aiLanguageSession']=null;}async[_0x2c09ea(0x259)](){const _0x18b421=_0x2c09ea,_0x19443d={'qXzZJ':_0x18b421(0x1fe),'YtZae':'âŒ\x20_checkWebGPUSupport:\x20No\x20WebGPU\x20adapter\x20found','XXTvx':_0x18b421(0x25b),'Rqisw':_0x18b421(0x228)};if(!navigator[_0x18b421(0x1d0)])return console['error'](_0x19443d[_0x18b421(0x204)]),![];try{const _0x3ba1af=await navigator[_0x18b421(0x1d0)][_0x18b421(0x247)]();if(!_0x3ba1af)return console[_0x18b421(0x253)](_0x19443d[_0x18b421(0x235)]),![];return console['log'](_0x19443d[_0x18b421(0x265)]),!![];}catch(_0x51bcb9){return console[_0x18b421(0x253)](_0x19443d[_0x18b421(0x211)],_0x51bcb9),![];}}async[_0x2c09ea(0x28f)](){const _0x3fafa7=_0x2c09ea,_0x3a4313={'XvLVV':'Main','OWyoQ':function(_0x2b8b42,_0x3e746e){return _0x2b8b42/_0x3e746e;},'VAMBB':function(_0x4f6f41,_0x4e657f){return _0x4f6f41-_0x4e657f;},'GGAAU':function(_0xda6b06,_0xb91d8e){return _0xda6b06>_0xb91d8e;},'oWVlB':function(_0x1375e9,_0x2899e2){return _0x1375e9/_0x2899e2;},'YeugA':function(_0x357a35,_0x254719){return _0x357a35*_0x254719;},'VmCys':'[MLC]\x20Loading\x20model\x20from\x20cache','EnsEq':'Loading\x20model\x20from\x20cache','uldlh':function(_0x12a2d4,_0x3b56ff,_0x4942f3){return _0x12a2d4(_0x3b56ff,_0x4942f3);},'IPUZF':function(_0x548520,_0x14e2b5){return _0x548520-_0x14e2b5;},'MKdDT':function(_0x1db24c,_0x1f6612){return _0x1db24c*_0x1f6612;},'mdCLY':'You\x20are\x20a\x20helpful\x20assistant1.','tXQeL':function(_0x121b93,_0x44508e){return _0x121b93-_0x44508e;},'kNKAB':_0x3fafa7(0x206),'YbLDl':_0x3fafa7(0x1ff),'vRoFu':_0x3fafa7(0x26b),'uhNxi':'[Init]\x20Failed\x20to\x20initialize\x20AI\x20language\x20model\x20session:','FeWzV':_0x3fafa7(0x285),'SxTqc':_0x3fafa7(0x1eb),'uzAgQ':_0x3fafa7(0x288),'qUqQx':_0x3fafa7(0x26a),'QqrEM':_0x3fafa7(0x1f7)};try{const _0x332529=await this[_0x3fafa7(0x259)]();if(!this[_0x3fafa7(0x1d9)])try{this[_0x3fafa7(0x23c)]=JSON[_0x3fafa7(0x1ee)](localStorage[_0x3fafa7(0x254)](_0x3fafa7(0x23c)))||{'temperature':0x1,'topK':0x3,'topP':0.9,'maxTokens':0x400,'systemRole':this['systemRole']||_0x3a4313[_0x3fafa7(0x23b)]},await this[_0x3fafa7(0x248)][_0x3fafa7(0x1f0)](this[_0x3fafa7(0x203)],{'useWorker':this[_0x3fafa7(0x1dd)],'onProgress':_0x4b94d2=>{const _0x3b6217=_0x3fafa7;console[_0x3b6217(0x275)]('['+(this['useWebWorker']?_0x3b6217(0x28a):_0x3a4313[_0x3b6217(0x1dc)])+_0x3b6217(0x222),_0x4b94d2);const _0xb388c=performance[_0x3b6217(0x1e9)](),_0x477997=_0x3a4313[_0x3b6217(0x25d)](_0x3a4313[_0x3b6217(0x231)](_0xb388c,this[_0x3b6217(0x23d)]),0x3e8);this[_0x3b6217(0x239)]=_0x4b94d2[_0x3b6217(0x1e7)],this[_0x3b6217(0x1e6)]=_0x4b94d2[_0x3b6217(0x264)],console['log'](_0x3b6217(0x21d),this[_0x3b6217(0x239)]);let _0x5e1239=0x0;if(_0x3a4313['GGAAU'](this[_0x3b6217(0x239)],0x0)){const _0x56e3b0=_0x3a4313[_0x3b6217(0x283)](_0x477997,_0x3a4313[_0x3b6217(0x284)](this[_0x3b6217(0x239)],0x64));_0x5e1239=_0x56e3b0*_0x3a4313[_0x3b6217(0x231)](0x64,_0x3a4313['YeugA'](this['progressPercent'],0x64)),this['loadingProgress']=_0x3a4313[_0x3b6217(0x284)](this[_0x3b6217(0x239)],0x64),this[_0x3b6217(0x276)]={'startTime':this[_0x3b6217(0x23d)],'progress':this[_0x3b6217(0x239)],'estimatedTimeRemaining':_0x5e1239};}else{if(this[_0x3b6217(0x1e6)][_0x3b6217(0x22e)](_0x3a4313[_0x3b6217(0x1f4)])){console['log'](_0x3a4313[_0x3b6217(0x20f)]);const _0x147b45=this[_0x3b6217(0x1e6)][_0x3b6217(0x1d6)](/Loading model from cache\[(\d+)\/(\d+)\]/);if(_0x147b45){const _0x2c8c21=_0x3a4313[_0x3b6217(0x1f6)](parseInt,_0x147b45[0x1],0xa),_0x570a31=_0x3a4313['uldlh'](parseInt,_0x147b45[0x2],0xa);this[_0x3b6217(0x208)]=_0x3a4313['OWyoQ'](_0x2c8c21,_0x570a31);const _0x1daed5=_0x477997/_0x2c8c21,_0x501f9d=_0x3a4313[_0x3b6217(0x26d)](_0x570a31,_0x2c8c21);_0x5e1239=_0x3a4313[_0x3b6217(0x284)](_0x1daed5,_0x501f9d),this['loadingProgress']=_0x3a4313[_0x3b6217(0x245)](this[_0x3b6217(0x208)],0x64),this[_0x3b6217(0x276)]={'startTime':this['startTime'],'progress':this[_0x3b6217(0x208)],'estimatedTimeRemaining':_0x5e1239};}}}}});const _0x10ddce=performance['now'](),_0x195b8f=_0x3a4313[_0x3fafa7(0x1f2)](_0x10ddce,this['startTime'])[_0x3fafa7(0x25e)](0x2);return this[_0x3fafa7(0x233)]=ModelTypes[_0x3fafa7(0x266)],this['progressText']=_0x3fafa7(0x244)+_0x195b8f+_0x3fafa7(0x287),this[_0x3fafa7(0x1d9)]=!![],this['progressPercent']=0x64,{'success':!![],'modelType':ModelTypes[_0x3fafa7(0x266)]};}catch(_0x110a9c){statusArea[_0x3fafa7(0x20a)]=_0x3fafa7(0x234)+_0x110a9c[_0x3fafa7(0x218)],console['error'](_0x110a9c);};if(!this['isInitialized']){if(this[_0x3fafa7(0x27d)]&&self['ai']&&self['ai'][_0x3fafa7(0x278)])try{const _0x27b2b3=_0x3a4313[_0x3fafa7(0x1d1)][_0x3fafa7(0x23e)]('|');let _0x398f3a=0x0;while(!![]){switch(_0x27b2b3[_0x398f3a++]){case'0':this[_0x3fafa7(0x1d9)]=!![];continue;case'1':this['modelType']=ModelTypes[_0x3fafa7(0x27b)];continue;case'2':return{'success':!![],'modelType':ModelTypes[_0x3fafa7(0x27b)]};case'3':!this[_0x3fafa7(0x229)]?(console['log'](_0x3a4313[_0x3fafa7(0x1d5)]),this[_0x3fafa7(0x229)]=await self['ai'][_0x3fafa7(0x278)][_0x3fafa7(0x246)]({'temperature':this[_0x3fafa7(0x23c)][_0x3fafa7(0x1d4)],'topK':this[_0x3fafa7(0x23c)][_0x3fafa7(0x21e)]}),console['log']('[Init]\x20âœ…\x20Language\x20model\x20session\x20created\x20successfully:',this[_0x3fafa7(0x229)]),Logger[_0x3fafa7(0x250)](_0x3fafa7(0x1d3)+this[_0x3fafa7(0x23c)][_0x3fafa7(0x1d4)]+_0x3fafa7(0x21f)+this[_0x3fafa7(0x23c)]['topK'])):console['log'](_0x3a4313[_0x3fafa7(0x20e)],this[_0x3fafa7(0x229)]);continue;case'4':this[_0x3fafa7(0x1e6)]=_0x3fafa7(0x212);continue;case'5':this['progressPercent']=0x64;continue;}break;}}catch(_0x577654){console[_0x3fafa7(0x253)](_0x3a4313[_0x3fafa7(0x1f8)],_0x577654),displayError(_0x3a4313['FeWzV']);}}return!this['isInitialized']&&(console[_0x3fafa7(0x202)](_0x3fafa7(0x1f5)),this[_0x3fafa7(0x233)]=ModelTypes['OPEN_AI']),this[_0x3fafa7(0x239)]=0x64,this[_0x3fafa7(0x1e6)]=_0x3fafa7(0x252),{'success':!![],'modelType':this[_0x3fafa7(0x233)]};}catch(_0x315682){const _0x1c8f20=_0x3a4313['SxTqc'][_0x3fafa7(0x23e)]('|');let _0x4d6eac=0x0;while(!![]){switch(_0x1c8f20[_0x4d6eac++]){case'0':console[_0x3fafa7(0x1f1)](_0x3a4313[_0x3fafa7(0x223)]);continue;case'1':console['group'](_0x3a4313[_0x3fafa7(0x1da)]);continue;case'2':return{'success':![],'error':_0x315682['message']};case'3':console[_0x3fafa7(0x25a)]();continue;case'4':console[_0x3fafa7(0x253)](_0x3a4313[_0x3fafa7(0x1f3)],_0x315682);continue;}break;}}}[_0x2c09ea(0x26c)](_0x235c73){const _0x3805b3=_0x2c09ea,_0x1a9bbb={'GKtVw':_0x3805b3(0x26f),'ZtlFn':function(_0x4caeda,_0x76c316){return _0x4caeda===_0x76c316;},'ywvfj':_0x3805b3(0x220)};console[_0x3805b3(0x275)](_0x1a9bbb[_0x3805b3(0x1fc)],_0x235c73);let _0x3a5a48=_0x235c73;if(_0x1a9bbb['ZtlFn'](typeof _0x3a5a48,_0x1a9bbb[_0x3805b3(0x1de)]))return console[_0x3805b3(0x275)](_0x3805b3(0x1e1)),_0x3a5a48;}async[_0x2c09ea(0x240)](_0x535adf){const _0x39fe66=_0x2c09ea,_0x1dcd95={'uxwbg':_0x39fe66(0x214),'cPzvs':function(_0x3cf3d0,_0x742f0a){return _0x3cf3d0(_0x742f0a);},'hPeYp':_0x39fe66(0x201),'qiniK':'ðŸ§¹\x20[aiAdapter]\x20Cleaned\x20response:','iBnZP':_0x39fe66(0x200),'OXeYZ':function(_0x28cb82,_0x197d88){return _0x28cb82(_0x197d88);},'wgQni':_0x39fe66(0x237),'jwwjm':function(_0x2fa8fb,_0x5a7d44,_0x2cfbdf){return _0x2fa8fb(_0x5a7d44,_0x2cfbdf);},'vnvcN':_0x39fe66(0x26e),'JqTgQ':'application/json','AJbzs':_0x39fe66(0x20b),'ptyzU':'Error\x20generating\x20AI\x20response\x20using\x20OpenAI\x20API.'};if(!this[_0x39fe66(0x1d9)])throw new Error(_0x39fe66(0x27a));if(this[_0x39fe66(0x248)]?.[_0x39fe66(0x1d8)]())try{return await this['engineWrapper'][_0x39fe66(0x24b)](_0x535adf,{...this['sessionConfig'],...options});}catch(_0x2c2815){console[_0x39fe66(0x253)](_0x1dcd95[_0x39fe66(0x22a)],_0x2c2815),_0x1dcd95[_0x39fe66(0x1db)](displayError,_0x1dcd95[_0x39fe66(0x282)]);}if(this[_0x39fe66(0x27d)]&&this['aiLanguageSession'])try{const _0x50ea96=await this[_0x39fe66(0x229)]['prompt'](_0x535adf);console[_0x39fe66(0x275)](_0x39fe66(0x24d),_0x50ea96);let _0x27e659=this[_0x39fe66(0x26c)](_0x50ea96);return _0x27e659={'choices':[{'message':{'content':_0x27e659}}]},console[_0x39fe66(0x275)](_0x1dcd95[_0x39fe66(0x227)],_0x27e659),_0x27e659;}catch(_0x4f4cbd){console['error'](_0x1dcd95[_0x39fe66(0x271)],_0x4f4cbd),_0x1dcd95[_0x39fe66(0x270)](displayError,_0x1dcd95[_0x39fe66(0x255)]);}console[_0x39fe66(0x202)](_0x39fe66(0x290),this[_0x39fe66(0x1ed)]);try{const _0x5188b9=await _0x1dcd95[_0x39fe66(0x21c)](fetch,OpenAIURL,{'method':_0x1dcd95[_0x39fe66(0x23a)],'headers':{'Authorization':_0x39fe66(0x249)+apiKey,'Content-Type':_0x1dcd95[_0x39fe66(0x1e5)]},'body':JSON[_0x39fe66(0x25f)]({'model':this[_0x39fe66(0x1ed)],'messages':_0x535adf,'temperature':this[_0x39fe66(0x23c)][_0x39fe66(0x1d4)],'stream':![]})});if(!_0x5188b9['ok'])throw new Error(_0x39fe66(0x217)+_0x5188b9['status']+'\x20'+_0x5188b9[_0x39fe66(0x1fb)]);return await _0x5188b9['json']();}catch(_0x31f60f){console[_0x39fe66(0x253)](_0x1dcd95[_0x39fe66(0x215)],_0x31f60f),displayError(_0x1dcd95[_0x39fe66(0x251)]);}}async['generateResponseStream'](_0x508766,_0x19fe41,_0x4f1237={}){const _0xbeb43a=_0x2c09ea,_0x135af0={'KfGVp':'Streaming\x20error:','exdxW':_0xbeb43a(0x27a),'wrSuf':function(_0x378edd,_0x5e99b0){return _0x378edd(_0x5e99b0);},'qEcjM':function(_0x5bc98c,_0x1b901f){return _0x5bc98c(_0x1b901f);},'CsSsj':_0xbeb43a(0x201),'EkEdi':function(_0x12e3c4,_0x149026,_0x2fa2f2){return _0x12e3c4(_0x149026,_0x2fa2f2);},'zBWjZ':_0xbeb43a(0x24e),'KtQcA':_0xbeb43a(0x237),'ccPSi':function(_0x41c927,_0x290823,_0xa8f88e){return _0x41c927(_0x290823,_0xa8f88e);},'qoCFL':'POST','tnvFH':_0xbeb43a(0x274),'cBaFp':function(_0x2ffc39,_0x3265bd,_0x3dbacd){return _0x2ffc39(_0x3265bd,_0x3dbacd);},'MUoAX':_0xbeb43a(0x230),'qEuKv':function(_0x3f05a0,_0x383fa8){return _0x3f05a0(_0x383fa8);}};if(!this[_0xbeb43a(0x1d9)])throw new Error(_0x135af0[_0xbeb43a(0x28e)]);const _0x36d14e=async _0x5ee6ed=>{const _0x334a55=_0xbeb43a;let _0x21a22e='';try{for await(const _0x32d94f of _0x5ee6ed){const _0x54c8e5=_0x32d94f[_0x334a55(0x267)]?.[0x0]?.[_0x334a55(0x219)]?.[_0x334a55(0x242)]??'';_0x21a22e+=_0x54c8e5;if(_0x19fe41)_0x19fe41(_0x54c8e5,_0x21a22e);}}catch(_0x787bdf){console[_0x334a55(0x253)](_0x135af0[_0x334a55(0x272)],_0x787bdf);}return _0x21a22e;};if(this['engineWrapper']?.[_0xbeb43a(0x1d8)]())try{const _0x44156e={...this['sessionConfig'],..._0x4f1237,'stream':!![]},_0x373229=await this[_0xbeb43a(0x248)]['generateResponseStream'](_0x508766,_0x44156e);return await _0x135af0['wrSuf'](_0x36d14e,_0x373229);}catch(_0x49678a){console[_0xbeb43a(0x253)](_0xbeb43a(0x207),_0x49678a),_0x135af0[_0xbeb43a(0x210)](displayError,_0x135af0['CsSsj']);}console['log'](_0xbeb43a(0x236),this['useBrowserAI'],this['aiLanguageSession']);if(this[_0xbeb43a(0x27d)]&&this[_0xbeb43a(0x229)]){console[_0xbeb43a(0x275)](_0xbeb43a(0x22f));try{const _0x184e9f=await this['aiLanguageSession']['promptStreaming'](JSON['stringify'](_0x508766));let _0x420397='';for await(const _0x421ce3 of _0x184e9f){_0x420397+=_0x421ce3,_0x135af0[_0xbeb43a(0x273)](_0x19fe41,_0x421ce3,_0x420397);}}catch(_0xad6277){console[_0xbeb43a(0x253)](_0x135af0[_0xbeb43a(0x257)],_0xad6277),_0x135af0[_0xbeb43a(0x286)](displayError,_0x135af0[_0xbeb43a(0x1e8)]);}}else try{const _0x44720e=await _0x135af0[_0xbeb43a(0x221)](fetch,OpenAIURL,{'method':_0x135af0[_0xbeb43a(0x27c)],'headers':{'Authorization':_0xbeb43a(0x249)+apiKey,'Content-Type':_0x135af0[_0xbeb43a(0x25c)]},'body':JSON[_0xbeb43a(0x25f)]({'model':this['defaultModel'],'messages':_0x508766,'temperature':this[_0xbeb43a(0x23c)][_0xbeb43a(0x1d4)],'stream':!![]})});if(!_0x44720e['ok'])throw new Error(_0xbeb43a(0x217)+_0x44720e[_0xbeb43a(0x28d)]+'\x20'+_0x44720e[_0xbeb43a(0x1fb)]);const _0x51d0cd=_0x44720e[_0xbeb43a(0x21b)][_0xbeb43a(0x1e0)]();let _0x4d1880=new TextDecoder(),_0x4ab45d=![],_0x29e17a='';while(!_0x4ab45d){const {value:_0xd2afda,done:_0xfba315}=await _0x51d0cd[_0xbeb43a(0x24c)]();_0x4ab45d=_0xfba315;if(_0xd2afda){const _0x399a97=_0x4d1880[_0xbeb43a(0x1d7)](_0xd2afda);_0x29e17a+=_0x399a97,_0x135af0[_0xbeb43a(0x20c)](_0x19fe41,_0x399a97,_0x29e17a);}}}catch(_0xcd6cb5){console[_0xbeb43a(0x253)](_0x135af0[_0xbeb43a(0x269)],_0xcd6cb5),_0x135af0['qEuKv'](displayError,'Error\x20generating\x20response\x20using\x20OpenAI\x20API.');}}[_0x2c09ea(0x1d2)](){const _0x580656=_0x2c09ea;if(!this[_0x580656(0x248)])return![];return this[_0x580656(0x248)][_0x580656(0x1d2)]();}[_0x2c09ea(0x1fa)](){const _0x37787f=_0x2c09ea,_0x468184={'kNtsW':_0x37787f(0x1e4)};this['aiLanguageSession']&&this[_0x37787f(0x229)][_0x37787f(0x289)](),this[_0x37787f(0x248)]&&this['engineWrapper'][_0x37787f(0x1fa)](),console[_0x37787f(0x275)](_0x468184[_0x37787f(0x262)]);}}export default AIAdapter;